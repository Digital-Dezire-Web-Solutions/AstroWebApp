<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Astro Market Web App</title>
    <!-- swiper slider css CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css"
        integrity="sha512-5Hs3dF2AEPkpNAR7UiOHba+lRSJNeM2ECkwxUIxC1Q/FLycGTbNapWXB4tP889k5T5Ju8fs4b1P5z/iB4nMfSQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Tempus Dominus CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="./css/style.css">

</head>

<body>


    <!-- __________________________________ 
     Our header Comp 
     ------------------------ -->

    <header class="header-comp">
        <div class="common-container3">

            <div class="header-flex-bx flex item-between">

                <div class="left-header-logo flex item-start gap">
                    <img src="./images/astrology.png" alt="">

                    <h6>Astroyogi</h6>

                </div>

                <div class="right-navbar class-rel flex item-start gap">
                    <div class="navbar class-rel">
                        <nav class="nav class-rel">
                            <div class="nav-lists flex item-start">
                                <li><a href="#">Calendar</a></li>
                                <li><a href="#">Market</a></li>
                                <li><a href="#">Kundali</a></li>
                                <li><a href="#">Affirmations</a></li>
                                <li><a href="#">Runes</a></li>
                                <li><a href="#">Healing</a></li>
                                <li><a href="#">Wisdom</a></li>
                            </div>
                        </nav>
                    </div>

                    <div class="header-icons-flex-bx class-rel flex gap">

                        <a href="#">
                            <button class="headr-btn">
                                <ion-icon name="cart-outline"></ion-icon>
                                <span>Store</span>
                            </button>
                        </a>

                        <a href="#">
                            <button id="login_btn" class="headr-btn headr-btn2">
                                <ion-icon name="person"></ion-icon>
                                <span>Login</span>
                            </button>
                        </a>

                    </div>

                    <button class="menu-bar-btn">
                        <i class="fa-solid fa-bars-staggered"></i>
                    </button>

                </div>

            </div>

        </div>
    </header>

    <!-- _______________________
       Our Login Reg Comp 
       ------------------ -->

    <section class="login-reg-comp">

        <div class="login-bx ">

            <button class="close-form-btn">
                <i class="fa-solid fa-xmark"></i>
            </button>

            <div class="login-info">

                <div class="login-logo">
                    <img src="./images/astrology.png" alt="">
                </div>



                <div class="comn-heading">
                    <h4>Sign In to Astrology </h4>
                    <!-- <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Minima maxime est obcaecati.</p> -->
                </div>

                <div class="login-form">
                    <form action="#">

                        <div class="inpt-bx">
                            <label for="email">Email Address</label>
                            <div class="inpt">
                                <input type="email" name="email" placeholder="Enter your email address..."
                                    autocomplete="off" required>
                            </div>
                        </div>

                        <div class="inpt-bx">
                            <label for="email">Password</label>
                            <div class="inpt">
                                <input type="password" name="password" placeholder="Enter your password..."
                                    autocomplete="off" required>
                            </div>
                        </div>




                    </form>

                    <div class="form-btns-flex">

                        <button class="form-btn">
                            Sign In
                        </button>

                        <button class="form-btn form-btn2" id="newAcnt">
                            Create Account
                        </button>

                    </div>

                </div>
            </div>

            <div class="reg-info">

                <div class="login-logo">
                    <img src="./images/astrology.png" alt="">
                </div>

                <div class="comn-heading">
                    <h4>Sign Up to Astrology </h4>
                    <!-- <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Minima maxime est obcaecati.</p> -->
                </div>

                <div class="login-form">
                    <form action="#">

                        <div class="inpt-bx">
                            <label for="name">Name</label>
                            <div class="inpt">
                                <input type="text" name="name" placeholder="Enter your Name" autocomplete="off"
                                    required>
                            </div>
                        </div>

                        <div class="inpt-bx">
                            <label for="name">Email</label>
                            <div class="inpt">
                                <input type="email" name="email" placeholder="Enter your email address..."
                                    autocomplete="off" required>
                            </div>
                        </div>

                        <div class="inpt-bx">
                            <label for="password">Create Password</label>
                            <div class="inpt">
                                <input type="text" name="createpassword" placeholder="Create your password..."
                                    autocomplete="off" required>
                            </div>
                        </div>


                        <div class="inpt-bx">
                            <label for="password">Date Of Birth</label>
                            <div class="inpt">
                                <input type="text" id="calendarInput" placeholder="Choose a date" />
                            </div>
                        </div>

                        <div class="inpt-bx">
                            <label for="password">Birth Time</label>
                            <div class="inpt">
                                <input type="text" id="timePicker" class="time-picker" placeholder="Select Time">
                            </div>
                        </div>
                        <div class="inpt-bx">
                            <label for="birthplace"> Birth Place</label>
                            <div class="inpt">
                                <input type="text" name="birthplace" placeholder="Enter your birth place..."
                                    autocomplete="off" required>
                            </div>
                        </div>


                    </form>

                    <div class="form-btns-flex">

                        <button class="form-btn">
                            Create Account
                        </button>

                        <button class="form-btn  form-btn3" id="signInBtn">
                            I Already Have Account
                        </button>

                    </div>

                </div>

            </div>

        </div>

    </section>

    <!-- ______________________________
        Our kundali comp 
        ----------------- -->


    <section class="kundali-comp">
        <div class="common-container3">

            <div class="kundali-container">
                <div class="kundali-img-bx">
                    <!-- Charts -->
                    <div class="kundli-img">
                        <div id="horoscope-chart1" class="chart-container1">
                            <!-- Lagna SVG will be injected here -->
                            <svg width="200" height="200" style="background-color: lightblue;">
                                <text x="50%" y="50%" text-anchor="middle" dominant-baseline="middle"
                                    font-size="20">Lagna Chart</text>
                            </svg>
                        </div>
                        <div id="horoscope-chart2" class="chart-container2" style="display: none;">
                            <!-- Navamsa SVG will be injected here -->
                            <svg width="200" height="200" style="background-color: lightcoral;">
                                <text x="50%" y="50%" text-anchor="middle" dominant-baseline="middle"
                                    font-size="20">Navamsa Chart</text>
                            </svg>
                        </div>
                        <div id="horoscope-chart3" class="chart-container3" style="display: none;">
                            <div class="planet-strength-box">
                                <div class="kundali-table">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th colspan="10"
                                                    style="text-align: center; font-weight: bold; margin-top: 2rem;">
                                                    <div class="gochara-house">
                                                        <label for="ghouse">Gochara House:</label>
                                                        <input type="text" id="ghouse" name="ghouse">
                                                    </div>
                                                    <div class="gochara-house">
                                                        <label for="currentLocation">Current Location:</label>
                                                        <input type="text" id="currentLocation" name="currentLocation">
                                                    </div>
                                                    <button class="gochara-house-btn"
                                                        onclick="fetchGocharaHouseData()">Get Gochara House
                                                        Data</button>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody id="gocharaHouseData"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="planet-strength-box">
                            <div class="kundali-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Planet</th>
                                            <th>Strength</th>
                                            <th>Nature</th>
                                        </tr>
                                    </thead>
                                    <tbody id="planetList"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Buttons to toggle -->
                    <div class="chart-toggle-buttons">
                        <button id="lagna-btn" class="active" onclick="showChart('lagna')">Lagna</button>
                        <button id="navamsa-btn" onclick="showChart('navamsa')">Navamsa</button>
                        <button id="more-btn" onclick="showChart('more')">Gochara House</button>
                    </div>
                </div>
            </div>

            <style>
                .kundali-img-bx {

                    position: relative;
                    margin-bottom: 8rem;
                }

                .kundli-img {
                    display: flex;
                    align-items: center;
                    justify-content: space-around;
                    position: relative;
                    width: 100%;
                }

                .chart-toggle-buttons {
                    position: absolute;
                    bottom: -60px;
                    left: 33%;
                    transform: translateX(-50%);
                    display: flex;
                    gap: 10px;
                }

                .chart-toggle-buttons button {
                    padding: 10px 20px;
                    border: none;
                    cursor: pointer;
                    background-color: #f0f0f0;
                    font-size: 16px;
                    border-radius: 5px;
                    transition: background-color 0.3s ease;
                }

                .chart-toggle-buttons button.active {
                    background-color: #fe7000;
                    color: white;
                }

                .kundli-img svg {
                    max-width: 100%;
                    max-height: 100%;
                }

                .gochara-house {
                    display: flex;
                    flex-direction: column;
                }

                .gochara-house-btn {
                    margin-top: 1rem;
                    padding: 10px 20px;
                    border: none;
                    cursor: pointer;
                    font-size: 16px;
                    border-radius: 5px;
                    transition: background-color 0.3s ease;
                    background-color: #fe7000;
                    color: white;
                }
            </style>



            <div class="kundali-table">
                <table>
                    <thead>
                        <tr>
                            <th>Planet</th>
                            <th>R</th>
                            <th>C</th>
                            <th>Zodiac</th>
                            <th>House</th>
                            <th>Nakshatra Lord</th>
                            <th>Nakshatra</th>
                            <th>Pada</th>
                            <th>Zodiac Lord</th>
                            <th>Latitude</th>

                        </tr>
                    </thead>
                    <tbody id="planet-data"></tbody>
                    <thead>
                        <tr>
                            <th colspan="10" style="text-align: center; font-weight: bold; margin-top: 2rem;">
                                Dasa Details
                            </th>
                        </tr>
                    </thead>
                    <tbody id="dasa-data"></tbody>
                    <thead>
                        <tr>
                            <th colspan="10" style="text-align: center; font-weight: bold; margin-top: 2rem;">
                                Panchang Details
                            </th>
                        </tr>
                    </thead>
                    <tbody id="panchang-data"></tbody>
                </table>
            </div>
            <div class="kundali-table">
                <table>
                    <thead>
                        <tr>
                            <th colspan="10" style="text-align: center; font-weight: bold; margin-top: 2rem;">
                                House Aspect by Planets ;
                                <label for="houseSelect">Select House:</label>
                                <select id="houseSelect">
                                    <option value="House1" selected>House 1</option>
                                    <option value="House2">House 2</option>
                                    <option value="House3">House 3</option>
                                    <option value="House4">House 4</option>
                                    <option value="House5">House 5</option>
                                    <option value="House6">House 6</option>
                                    <option value="House7">House 7</option>
                                    <option value="House8">House 8</option>
                                    <option value="House9">House 9</option>
                                    <option value="House10">House 10</option>
                                    <option value="House11">House 11</option>
                                    <option value="House12">House 12</option>
                                    <!-- Add more houses as needed -->
                                </select>
                            </th>
                        </tr>
                    </thead>
                    <tbody id="aspectData"></tbody>
                </table>

            </div>
            <div class="kundali-table">
                <table>
                    <thead>
                        <tr>
                            <th colspan="10" style="text-align: center; font-weight: bold; margin-top: 2rem;">
                                Benefic Aspect Data
                            </th>
                        </tr>
                    </thead>
                    <tbody id="beneficAspectData"></tbody>
                </table>
            </div>
            <div class="kundali-table">
                <h5>All Planet House Data</h5>
                <label for="house-select">Select House:</label>
                <select id="house-select">
                    <option value="" selected>Select House</option>
                    <option value="House1">House 1</option>
                    <option value="House2">House 2</option>
                    <option value="House3">House 3</option>
                    <option value="House4">House 4</option>
                    <option value="House5">House 5</option>
                    <option value="House6">House 6</option>
                    <option value="House7">House 7</option>
                    <option value="House8">House 8</option>
                    <option value="House9">House 9</option>
                    <option value="House10">House 10</option>
                    <option value="House11">House 11</option>
                    <option value="House12">House 12</option>
                    <!-- Add more houses as needed -->
                </select>

                <table id="data-table">
                    <thead>
                        <tr>
                            <th>Planet</th>
                            <th>Is House Aspected By Planet</th>
                            <th>Is Planet In Good Aspect To House</th>
                            <th>Is Planet In House</th>
                            <th>Planet Relationship With House</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="5">No data available. Select a house to view data.</td>
                        </tr>
                    </tbody>
                </table>
            </div>


            <script>
                function showChart(chartType) {
                    // Get chart containers and buttons
                    const lagnaChart = document.getElementById("horoscope-chart1");
                    const navamsaChart = document.getElementById("horoscope-chart2");
                    const moreChart = document.getElementById("horoscope-chart3");
                    const lagnaBtn = document.getElementById("lagna-btn");
                    const navamsaBtn = document.getElementById("navamsa-btn");
                    const moreBtn = document.getElementById("more-btn");

                    if (chartType === "lagna") {
                        lagnaChart.style.display = "block";
                        navamsaChart.style.display = "none";
                        moreChart.style.display = "none";
                        lagnaBtn.classList.add("active");
                        navamsaBtn.classList.remove("active");
                        moreBtn.classList.remove("active");
                    } else if (chartType === "navamsa") {
                        lagnaChart.style.display = "none";
                        navamsaChart.style.display = "block";
                        moreChart.style.display = "none";
                        navamsaBtn.classList.add("active");
                        lagnaBtn.classList.remove("active");
                        moreBtn.classList.remove("active");
                    } else if (chartType === "more") {
                        lagnaChart.style.display = "none";
                        navamsaChart.style.display = "none";
                        moreChart.style.display = "block";
                        moreBtn.classList.add("active");
                        lagnaBtn.classList.remove("active");
                        navamsaBtn.classList.remove("active");
                    }
                }
            </script>
            <script>
                // Retrieve data from localStorage
                const params = JSON.parse(localStorage.getItem('params'));
                const horoscopeData = JSON.parse(localStorage.getItem('horoscopeData'));
                const strengthData = JSON.parse(localStorage.getItem('strengthData'));
                const natureData = JSON.parse(localStorage.getItem('natureData'));
                const chart1Url = localStorage.getItem('chart1Data');
                const chart2Url = localStorage.getItem('chart2Data');
                const chartContainer1 = document.getElementById("horoscope-chart1");
                chartContainer1.innerHTML = chart1Url;
                const chartContainer2 = document.getElementById("horoscope-chart2");
                chartContainer2.innerHTML = chart2Url;

                const ApiUrl = "https://vedastroapi.azurewebsites.net/api/Calculate"

                // data calling
                const fetchHouseAspectData = async (house = "House1") => {
                    try {

                        const houseAspectUrl = `${ApiUrl}/IsHouseAspectedByPlanet/HouseName/${house}/PlanetName/All9WithUpagrahas/Location/${params.location}/Time/${params.tob}/${params.dob}/+05:30`;
                        const response = await fetch(houseAspectUrl);
                        console.log(houseAspectUrl, "houseAspectUrl")

                        if (!response.ok) throw new Error("Failed to fetch aspect by house data.");

                        const houseAspectData = await response.json();
                        if (houseAspectData.Status === "Pass") {
                            displayAspectData(house, houseAspectData.Payload.IsHouseAspectedByPlanet);
                        } else {
                            throw new Error("Data status is not Pass.");
                        }
                    } catch (error) {
                        document.getElementById("aspectData").innerHTML = `<p style="color:red;">Error: ${error.message}</p>`;
                    }
                };

                const displayAspectData = (house, data) => {
                    const aspectDataDiv = document.getElementById("aspectData");

                    if (data && Array.isArray(data)) {
                        let tableHTML = `
                <td>Planet</td>
                <td>Aspect Data for : ${house}</td>
                `;
                        data.forEach(aspect => {
                            const planet = Object.keys(aspect)[0];
                            const isAspected = aspect[planet] === "True" ? "True" : "-";;
                            tableHTML += `
                <tr>
                    <td>${planet}</td>
                    <td>${isAspected}</td>
                </tr>
            `;
                        });
                        aspectDataDiv.innerHTML = tableHTML;
                    } else {
                        aspectDataDiv.innerHTML = `<p>No aspect data available for ${house}.</p>`;
                    }
                };
                document.getElementById("houseSelect").addEventListener("change", (event) => {
                    const selectedHouse = event.target.value;
                    fetchHouseAspectData(selectedHouse);
                });
                fetchHouseAspectData();

                // Function to fetch Gochara House data
                const fetchGocharaHouseData = async () => {
                    const ghouse = document.getElementById("ghouse").value;
                    const currentLocation = document.getElementById("currentLocation").value;
                    const currentIST = new Date();
                    currentIST.setMinutes(currentIST.getMinutes() + currentIST.getTimezoneOffset() + 330); // Add 330 minutes for IST
                    const currentTime = `${String(currentIST.getHours()).padStart(2, '0')}:${String(currentIST.getMinutes()).padStart(2, '0')}:${String(currentIST.getSeconds()).padStart(2, '0')}`;
                    const currentDate = new Date();
                    const formattedDate = `${String(currentDate.getDate()).padStart(2, '0')}/${String(currentDate.getMonth() + 1).padStart(2, '0')}/${currentDate.getFullYear()}`;

                    try {
                        const gocharaHouseUrl = `${ApiUrl}/PlanetsInGocharaHouse/Location/${params.location}/Time/${params.tob}/${params.dob}/+05:30/Location/${currentLocation}/Time/${currentTime}/${formattedDate}/+05:30/GocharaHouse/${ghouse}`;
                        const response = await fetch(gocharaHouseUrl);

                        if (!response.ok) throw new Error("Failed to fetch Gochara House data.");

                        const gocharaHouseData = await response.json();
                        if (gocharaHouseData.Status === "Pass") {
                            displayGocharaHouseData(gocharaHouseData.Payload.PlanetsInGocharaHouse);
                        } else {
                            throw new Error("Data status is not Pass.");
                        }
                    } catch (error) {
                        document.getElementById("gocharaHouseData").innerHTML = `<p style="color:red;">Error: ${error.message}</p>`;
                    }
                };

                const displayGocharaHouseData = (data) => {
                    const gocharaHouseDataDiv = document.getElementById("gocharaHouseData");

                    if (data && Array.isArray(data) && data.length > 0) {
                        let tableHTML = `
            
            `;

                        data.forEach(item => {
                            tableHTML += `
                <tr>
                    <td>Planet in Gochara House</td>
                    <td>${item}</td>
                </tr>
                `;
                        });

                        gocharaHouseDataDiv.innerHTML = `<table>${tableHTML}</table>`;
                    } else {
                        gocharaHouseDataDiv.innerHTML = `<tr>
                    <td>Planet in Gochara House</td>
                    <td>No Data Found</td>
                </tr>`;
                    }
                };
                // Ensure horoscopeData exists before proceeding
                if (horoscopeData && horoscopeData.response) {
                    const planetDatas = horoscopeData.response;

                    // Function to check if a value is defined
                    const isDefined = (value) => value !== undefined && value !== null && value !== "";

                    // Map Planet Data
                    const mapPlanetData = (data) => {
                        if (Array.isArray(data)) {
                            // If data is an array, map directly
                            return data.map((planet) => ({
                                name: planet.full_name,
                                zodiac: planet.zodiac,
                                house: planet.house,
                                nakshatra: planet.nakshatra,
                                nakshatra_lord: planet.nakshatra_lord,
                                zodiac_lord: planet.zodiac_lord,
                                latitude: planet.local_degree,
                                rishi: planet.nakshatra_lord,
                                nakshatra_pada: planet.nakshatra_pada,
                                relation: planet.zodiac_lord,
                                retro: planet.retro,
                                is_combust: planet.is_combust,
                            }));
                        } else if (typeof data === "object" && data !== null) {
                            // If data is an object, map its values
                            return Object.values(data).map((planet) => ({
                                name: planet.full_name,
                                zodiac: planet.zodiac,
                                house: planet.house,
                                nakshatra: planet.nakshatra,
                                nakshatra_lord: planet.nakshatra_lord,
                                zodiac_lord: planet.zodiac_lord,
                                latitude: planet.local_degree,
                                rishi: planet.nakshatra_lord,
                                nakshatra_pada: planet.nakshatra_pada,
                                relation: planet.zodiac_lord,
                                retro: planet.retro,
                                is_combust: planet.is_combust,
                            }));
                        } else {
                            console.error("Unexpected data format for planets:", data);
                            return [];
                        }
                    };

                    // Map Dasa Details
                    const mapDasaDetails = (data) => {
                        return {
                            birth_dasa: planetDatas.birth_dasa,
                            current_dasa: planetDatas.current_dasa,
                            lucky_gem: planetDatas.lucky_gem,
                            lucky_num: planetDatas.lucky_num,
                            lucky_colors: planetDatas.lucky_colors,
                            lucky_letters: planetDatas.lucky_letters,
                            rasi: planetDatas.rasi,
                        };
                    };

                    // Map Dasa Details
                    const mapPanchangDetails = (data) => {
                        return {
                            ayanamsa: planetDatas.panchang.ayanamsa,
                            ayanamsa_name: planetDatas.panchang.ayanamsa_name,
                            karana: planetDatas.panchang.karana,
                            yoga: planetDatas.panchang.yoga,
                            day_of_birth: planetDatas.panchang.day_of_birth,
                            day_lord: planetDatas.panchang.day_lord,
                            hora_lord: planetDatas.panchang.hora_lord,
                            sunrise_at_birth: planetDatas.panchang.sunrise_at_birth,
                            sunset_at_birth: planetDatas.panchang.sunset_at_birth,
                            tithi: planetDatas.panchang.tithi,
                        };
                    };

                    // Populate Table
                    const populateTable = () => {
                        const planetDataElement = document.getElementById("planet-data");
                        const dasaDataElement = document.getElementById("dasa-data");
                        const panchangDataElement = document.getElementById("panchang-data");

                        if (!horoscopeData || !horoscopeData.response) {
                            console.error("Horoscope data is invalid or missing.");
                            return;
                        }

                        // Map Data
                        const planets = mapPlanetData(horoscopeData.response);
                        const dasaDetails = mapDasaDetails(horoscopeData);
                        const panchangDetails = mapPanchangDetails(horoscopeData);

                        // Add Planets Data to Table
                        planets.forEach((planet) => {
                            // Create the table row
                            const row = document.createElement("tr");

                            // Check if at least one field has valid data
                            const hasValidData = [
                                planet.name,
                                planet.zodiac,
                                planet.house,
                                planet.nakshatra,
                                planet.nakshatra_lord,
                                planet.zodiac_lord,
                                planet.latitude,
                                planet.rishi,
                                planet.nakshatra_pada,
                                planet.relation,
                                planet.is_combust,
                                planet.retro
                            ].some((value) => isDefined(value));

                            // If the row has valid data, populate the row
                            if (hasValidData) {
                                row.innerHTML = `
            <td>${isDefined(planet.name) ? planet.name : "-"}</td>
            <td>${planet.retro ? "R" : " "}</td>
            <td>${planet.is_combust ? "C" : " "}</td>
            <td>${isDefined(planet.zodiac) ? planet.zodiac : "-"}</td>
            <td>${isDefined(planet.house) ? planet.house : "-"}</td>
            <td>${isDefined(planet.nakshatra_lord) ? planet.nakshatra_lord : "-"}</td>
            <td>${isDefined(planet.nakshatra) ? planet.nakshatra : "-"}</td>
            <td>${isDefined(planet.nakshatra_pada) ? planet.nakshatra_pada : "-"}</td>
            <td>${isDefined(planet.zodiac_lord) ? planet.zodiac_lord : "-"}</td>
            <td>${isDefined(planet.latitude) ? planet.latitude : "-"}</td>
        `;

                                planetDataElement.appendChild(row);
                            }
                        });

                        // Utility function to check if a value is defined and not blank
                        function isDefined(value) {
                            return value !== undefined && value !== null && value !== "";
                        }

                        // Add Dasa Details to Table
                        dasaDataElement.innerHTML = `
<tr>
          <td colspan="2"><strong>Birth Dasa:</strong></td>
          <td colspan="8">${dasaDetails.birth_dasa || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Current Dasa:</strong></td>
          <td colspan="8">${dasaDetails.current_dasa || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Lucky Gem:</strong></td>
          <td colspan="8">${dasaDetails.lucky_gem || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Lucky Number:</strong></td>
          <td colspan="8">${dasaDetails.lucky_num || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Lucky Colors:</strong></td>
          <td colspan="8">${dasaDetails.lucky_colors || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Lucky Letters:</strong></td>
          <td colspan="8">${dasaDetails.lucky_letters || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Rasi:</strong></td>
          <td colspan="8">${dasaDetails.rasi || ""}</td>
        </tr>
  `;
                        // Add Dasa Details to Table
                        panchangDataElement.innerHTML = `
<tr>
          <td colspan="2"><strong>Ayanamsa:</strong></td>
          <td colspan="8">${panchangDetails.ayanamsa || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Ayanamsa_name:</strong></td>
          <td colspan="8">${panchangDetails.ayanamsa_name || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Karana:</strong></td>
          <td colspan="8">${panchangDetails.karana || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Yoga:</strong></td>
          <td colspan="8">${panchangDetails.yoga || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Day of birth:</strong></td>
          <td colspan="8">${panchangDetails.day_of_birth || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Day lord:</strong></td>
          <td colspan="8">${panchangDetails.day_lord || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Hora lord:</strong></td>
          <td colspan="8">${panchangDetails.hora_lord || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Sunrise at birth:</strong></td>
          <td colspan="8">${panchangDetails.sunrise_at_birth || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Sunset at birth:</strong></td>
          <td colspan="8">${panchangDetails.sunset_at_birth || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Tithi:</strong></td>
          <td colspan="8">${panchangDetails.tithi || ""}</td>
        </tr>
  `;
                    };


                    // Populate table on page load
                    window.onload = populateTable;
                } else {
                    console.error("Horoscope data not found or invalid in localStorage.");
                }

                // Function to render the planet strengths and nature
                function renderPlanetStrengths() {
                    const planetList = document.getElementById('planetList');

                    // Clear existing rows (if any)
                    planetList.innerHTML = "";

                    // Convert nature data into an object for easier lookup
                    const natureData1 = natureData.Payload.IsPlanetBenefic.reduce((acc, item) => {
                        const [planetName, value] = Object.entries(item)[0];
                        acc[planetName] = value === 'True' ? "Benefic" : "Malefic";
                        return acc;
                    }, {});

                    // Check if strengthData and the required properties exist
                    if (!strengthData || !strengthData.Payload || !Array.isArray(strengthData.Payload.PlanetStrength)) {
                        console.error("Invalid strength data structure.");
                        return;
                    }
                    const limitedPlanets = strengthData.Payload.PlanetStrength.slice(0, 9);

                    // Loop through each planet and create table rows
                    limitedPlanets.forEach((planet) => {
                        // Get the planet name and value
                        const [planetName, value] = Object.entries(planet)[0];
                        const nature = natureData1[planetName] || "Unknown";
                        const row = document.createElement("tr");

                        // Create content for planet name, value, and nature
                        row.innerHTML = `
            <td class="planet-name">${planetName}:</td>
            <td class="planet-value">${value}</td>
            <td class="planet-nature">${nature}</td>
        `;

                        // Append the row to the list
                        planetList.appendChild(row);
                    });
                }

                // Call the function to render the data
                renderPlanetStrengths();

                // Function to fetch and display data from the provided API
                const fetchBeneficAspectData = async () => {
                    const BeneficAspect = `${ApiUrl}/IsPlanetAspectedByBeneficPlanets/PlanetName/All9WithUpagrahas/Location/${params.location}/Time/${params.tob}/${params.dob}/+05:30`;

                    try {
                        const response = await fetch(BeneficAspect);
                        if (!response.ok) throw new Error("Failed to fetch benefic aspect data.");

                        const data = await response.json();
                        if (data.Status === "Pass") {
                            displayBeneficAspectData(data.Payload.IsPlanetAspectedByBeneficPlanets);
                        } else {
                            throw new Error("Data status is not Pass.");
                        }
                    } catch (error) {
                        document.getElementById("beneficAspectData").innerHTML = `<p style="color:red;">Error: ${error.message}</p>`;
                    }
                };

                const displayBeneficAspectData = (data) => {
                    const beneficAspectDataDiv = document.getElementById("beneficAspectData");

                    if (data && Array.isArray(data)) {
                        let tableHTML = `
                    <tr>
                        <th>Planet</th>
                        <th>Is Aspected by Benefic Planets</th>
                    </tr>
                `;
                        data.forEach(aspect => {
                            const planet = Object.keys(aspect)[0];
                            const isAspected = aspect[planet] === "True" ? "True" : "-";
                            tableHTML += `
                        <tr>
                            <td>${planet}</td>
                            <td>${isAspected}</td>
                        </tr>
                    `;
                        });
                        beneficAspectDataDiv.innerHTML = `<table>${tableHTML}</table>`;
                    } else {
                        beneficAspectDataDiv.innerHTML = `<p>No benefic aspect data available.</p>`;
                    }
                };

                // Call the function to fetch and display the data
                fetchBeneficAspectData();
                const tableBody = document.querySelector("#data-table tbody");
                const houseSelect = document.getElementById("house-select");

                houseSelect.addEventListener("change", async function () {
                    const selectedHouse = houseSelect.value;
                    if (!selectedHouse) {
                        tableBody.innerHTML = `<tr><td colspan="5">No data available. Select a house to view data.</td></tr>`;
                        return;
                    }

                    try {
                        const response = await fetch(`${ApiUrl}/AllPlanetHouseData/PlanetName/All9WithUpagrahas/HouseName/${selectedHouse}/Location/${params.location}/Time/${params.tob}/${params.dob}/+05:30`);
                        const data = await response.json();

                        if (data.Status === "Pass" && data.Payload.AllPlanetHouseData) {
                            const planetData = data.Payload.AllPlanetHouseData;

                            tableBody.innerHTML = "";
                            planetData.forEach((planet) => {
                                const [planetName, details] = Object.entries(planet)[0];
                                const row = `
              <tr>
                <td>${planetName}</td>
                <td>${details.IsHouseAspectedByPlanet}</td>
                <td>${details.IsPlanetInGoodAspectToHouse}</td>
                <td>${details.IsPlanetInHouse}</td>
                <td>${details.PlanetRelationshipWithHouse}</td>
              </tr>
            `;
                                tableBody.innerHTML += row;
                            });
                        } else {
                            tableBody.innerHTML = `<tr><td colspan="5">No data available for the selected house.</td></tr>`;
                        }
                    } catch (error) {
                        console.error("Error fetching data:", error);
                        tableBody.innerHTML = `<tr><td colspan="5">Error fetching data. Please try again later.</td></tr>`;
                    }
                });
            </script>

            <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
            <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
            <!-- Swiper Js file -->
            <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
            <!-- script file -->
            <script src="./js/index.js"></script>



</body>

</html>