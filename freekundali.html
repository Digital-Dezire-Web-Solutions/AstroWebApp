<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Home | Astro Nivesh</title>
    <!-- swiper slider css CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css"
        integrity="sha512-5Hs3dF2AEPkpNAR7UiOHba+lRSJNeM2ECkwxUIxC1Q/FLycGTbNapWXB4tP889k5T5Ju8fs4b1P5z/iB4nMfSQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Tempus Dominus CSS -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="icon" href="/images/astrology.png" />
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZF2CQTE5JG"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-ZF2CQTE5JG');
    </script>
    <script src="https://cdn.pagesense.io/js/astronivesh/b70b9482d2454a09ac5feadc3675f35c.js"></script>

</head>

<body>
    <section class="top-header-comp">
        <div class="common-container3 top-header-flex flex item-between">
            <div class="left-header-logo flex item-start gap" onclick="window.location.href='home.html'">
                <img src="./images/astrology.png" alt="">

                <h6>Astro Nivesh</h6>

            </div>

            <div class="right-top-header-flex-bx flex item-start gap">

                <div class="top-hedr-bx flex item-center">
                    <div class="left-hedr-icon">
                        <ion-icon name="call"></ion-icon>
                    </div>
                    <div class="right-hedr-inof">
                        <h6>Talk to Us</h6>
                        <span>+91-8421616117</span>
                    </div>
                </div>


                <button class="menu-bar-btn">
                    <ion-icon name="menu"></ion-icon>
                </button>



                <button class="apnt-btn" onclick="window.location.href='appointments.html'">
                    Talk to Astrologer
                </button>

                <div class="profile-bx" id="login_btn">
                    <ion-icon name="person-circle-outline" size="large" color="#fe7000"></ion-icon>
                    <p id="profile-name">LogIn / Reg.</p>
                </div>

            </div>

        </div>
    </section>


    <header class="header">
        <div class="common-container3 header-flex flex item-between gap">

            <div class="nav-overlay"></div>
            <div class="navbar">

                <button class="close-nav-btn">
                    <ion-icon name="close-circle"></ion-icon>
                </button>

                <div class="left-header-logo flex item-start gap mob-logo" onclick="window.location.href='home.html'">
                    <img src="./images/astrology.png" alt="">

                    <h6>Astro Nivesh</h6>

                </div>

                <div class="search-inpt-bx search-inpt-bx-mob">
                    <input type="text" name="search" id="search" placeholder="Search here...">
                    <button class="search-btn">
                        <ion-icon name="search"></ion-icon>
                    </button>
                </div>

                <nav class="nav">
                    <div class="nav-lists flex item-start">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="kundali.html">Kundali</a></li>
                        <li><a href="market.html">Market</a></li>
                        <li><a href="appointments.html">Talk to Astrologer</a></li>
                    </div>
                </nav>

                <div class="astrology-cont-info">

                    <!-- <div class="top-hedr-bx flex item-center">
                        <div class="left-hedr-icon">
                            <ion-icon name="home"></ion-icon>
                        </div>
                        <div class="right-hedr-inof">
                            <h6>Reach Us</h6>
                            <span>601 , Ram Nagar Dewas</span>
                        </div>
                    </div> -->

                    <div class="top-hedr-bx flex item-center">
                        <div class="left-hedr-icon">
                            <ion-icon name="call"></ion-icon>
                        </div>
                        <div class="right-hedr-inof">
                            <h6>Talk to Us</h6>
                            <span>+91-8421616117</span>
                        </div>
                    </div>

                </div>


                <button class="apnt-btn apnt-btn-mob" onclick="window.location.href='appointments.html'">
                    Talk to Astrologer
                </button>

            </div>

            <div class="right-header-flex flex item-start ">
                <div class="search-inpt-bx">
                    <input type="text" name="search" id="search" placeholder="Search here...">
                    <button class="search-btn">
                        <ion-icon name="search"></ion-icon>
                    </button>
                </div>



            </div>

        </div>
    </header>


    <!-- __________________________________ 
     Our Home Comp 
     ------------------------ -->

    <main class="main">
        <div class="common-container3">
            <div class="comn-heading">
                <h3>Generate Free Kundali</h3>
            </div>
            <div class="home-box">
                <div class="login-form">
                    <form onsubmit="handleCreate(event)">

                        <div class="home-input-box">

                            <div class="inpt-bx">
                                <label for="password">Date Of Birth</label>
                                <div class="inpt">
                                    <input type="text" id="calendarInput" name="calendarInput"
                                        placeholder="Choose a date">
                                </div>
                            </div>

                            <div class="inpt-bx">
                                <label for="password">Birth Time</label>
                                <div class="inpt">
                                    <input type="text" id="timePicker" name="timePicker" class="time-picker"
                                        placeholder="Select Time">
                                </div>
                            </div>
                            <div class="inpt-bx">
                                <label for="birthplace">Birth Place</label>
                                <div class="inpt">
                                    <input type="text" id="birthplace" name="birthplace"
                                        placeholder="Enter your Birth Place..." autocomplete="off" required>
                                    <ul id="suggestions" class="suggestions-list"></ul>
                                </div>
                            </div>
                            <input type="hidden" id="latitude" name="latitude">
                            <input type="hidden" id="longitude" name="longitude">
                            <div class="form-btns-flex" style="margin: 0;">
                                <button class="form-btn" type="submit" style="margin: 0;">
                                    Generate kundali
                                </button>
                            </div>
                        </div>

                    </form>
                </div>
                <div class="signup-loader home">
                    <div class="login-logo">
                        <img src="./images/astrology.png" alt="">
                    </div>
                    <div class="comn-heading">
                        <h4>Astro Nivesh</h4>
                    </div>
                    <!-- From Uiverse.io by Li-Deheng -->
                    <div class="loader">
                        <div class="circle">
                            <div class="dot"></div>
                            <div class="outline"></div>
                        </div>
                        <div class="circle">
                            <div class="dot"></div>
                            <div class="outline"></div>
                        </div>
                        <div class="circle">
                            <div class="dot"></div>
                            <div class="outline"></div>
                        </div>
                        <div class="circle">
                            <div class="dot"></div>
                            <div class="outline"></div>
                        </div>
                    </div>
                    <div class="comn-heading">
                        <h4>Signing Up.....</h4>
                    </div>
                </div>
            </div>


        </div>
    </main>

    <!-- _______________________
       Our Login Reg Comp 
       ------------------ -->

    <section class="login-reg-comp">

        <div class="login-bx ">

            <button class="close-form-btn">
                <i class="fa-solid fa-xmark"></i>
            </button>

            <div class="login-info">

                <button style="display: none;" disabled type="button" class="form-btn form-btn2" id="newAcnt">
                    Create Account
                </button>

            </div>


            <div class="reg-info">

                <div class="login-form">
                    <button class="form-btn  form-btn3" type="button" id="signInBtn">
                        I Already Have Account
                    </button>
                </div>
            </div>

            <div class="signup-loader home" style="display: none;">
                <div class="login-logo">
                    <img src="./images/astrology.png" alt="">
                </div>
                <div class="comn-heading">
                    <h4>Astro Nivesh</h4>
                </div>
                <!-- From Uiverse.io by Li-Deheng -->
                <div class="loader">
                    <div class="circle">
                        <div class="dot"></div>
                        <div class="outline"></div>
                    </div>
                    <div class="circle">
                        <div class="dot"></div>
                        <div class="outline"></div>
                    </div>
                    <div class="circle">
                        <div class="dot"></div>
                        <div class="outline"></div>
                    </div>
                    <div class="circle">
                        <div class="dot"></div>
                        <div class="outline"></div>
                    </div>
                </div>
                <div class="comn-heading">
                    <h4>Signing Up.....</h4>
                </div>
            </div>

            <div class="profile-info">
                <div class="login-logo">
                    <img src="./images/astrology.png" alt="">
                </div>
                <div class="comn-heading">
                    <h4>Astro Nivesh</h4>
                </div>

                <div id="profile-body"></div>
                <a style=" display: flex; align-items: center; justify-content: center;  font-size: 18px; padding-top: 1rem;"
                    href="profile.html"><i class="fa-solid fa-user" style="margin-right: 10px;"></i>My Profile</a>

                <div class="logout-bx" id="logoutBox">
                    <p><ion-icon name="log-out"></ion-icon>Log Out</p>
                </div>
            </div>

        </div>

    </section>


    <!-- _______________________
      Our cards comp 
      ------------------------ -->
    <style>
        .coming-soon {
            filter: grayscale(5);
        }

        .coming-soon .card-info {
            color: #ffffff;
            display: none;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
            overflow: visible;
            border-radius: .7rem;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 3;
            background: #dcdcdc;
            transition: ease-in-out
        }

        .coming-soon:hover .card-info {
            color: white;
            transition: color 1s;
            display: flex;
            transition: ease-in-out;
        }

        .coming-soon .card-info p {
            color: white;
        }

        /* ....loader..... */
        /* From Uiverse.io by Li-Deheng */
        .loader {
            display: flex;
            justify-content: center;
            align-items: center;
            --color: hsl(0, 0%, 87%);
            --animation: 2s ease-in-out infinite;
        }

        .loader .circle {
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            width: 20px;
            height: 20px;
            border: solid 2px var(--color);
            border-radius: 50%;
            margin: 0 10px;
            background-color: transparent;
            animation: circle-keys var(--animation);
        }

        .loader .circle .dot {
            position: absolute;
            transform: translate(-50%, -50%);
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: var(--color);
            animation: dot-keys var(--animation);
        }

        .loader .circle .outline {
            position: absolute;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            border-radius: 50%;
            animation: outline-keys var(--animation);
        }

        .circle:nth-child(2) {
            animation-delay: 0.3s;
        }

        .circle:nth-child(3) {
            animation-delay: 0.6s;
        }

        .circle:nth-child(4) {
            animation-delay: 0.9s;
        }

        .circle:nth-child(5) {
            animation-delay: 1.2s;
        }

        .circle:nth-child(2) .dot {
            animation-delay: 0.3s;
        }

        .circle:nth-child(3) .dot {
            animation-delay: 0.6s;
        }

        .circle:nth-child(4) .dot {
            animation-delay: 0.9s;
        }

        .circle:nth-child(5) .dot {
            animation-delay: 1.2s;
        }

        .circle:nth-child(1) .outline {
            animation-delay: 0.9s;
        }

        .circle:nth-child(2) .outline {
            animation-delay: 1.2s;
        }

        .circle:nth-child(3) .outline {
            animation-delay: 1.5s;
        }

        .circle:nth-child(4) .outline {
            animation-delay: 1.8s;
        }

        .circle:nth-child(5) .outline {
            animation-delay: 2.1s;
        }

        @keyframes circle-keys {
            0% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.5);
                opacity: 0.5;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes dot-keys {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(0);
            }

            100% {
                transform: scale(1);
            }
        }

        @keyframes outline-keys {
            0% {
                transform: scale(0);
                outline: solid 20px var(--color);
                outline-offset: 0;
                opacity: 1;
            }

            100% {
                transform: scale(1);
                outline: solid 0 transparent;
                outline-offset: 20px;
                opacity: 0;
            }
        }

        .suggestions-list {
            list-style: none;
            padding: 0;
            margin: 0;
            background: white;
            border: 1px solid #ccc;
            position: absolute;
            z-index: 1000;
            width: 100%;
        }

        .suggestions-list li {
            padding: 8px;
            cursor: pointer;
        }

        .suggestions-list li:hover {
            background-color: #f0f0f0;
        }
    </style>

    <!-- ______________________________
        Our kundali comp 
        ----------------- -->


    <section class="kundali-comp">
        <div class="common-container3">

            <div class="kundali-container">
                <h5>Kundali Chart</h5>
                <div class="kundali-img-bx">
                    <!-- Charts -->
                    <div class="kundli-img">
                        <div class="kundali-img-nres">
                            <div class="kundli-chart">
                                <div id="horoscope-chart1" class="chart-container1">
                                    <p>Lagna</p>
                                </div>
                                <p>Lagna</p>
                            </div>
                            <div class="kundli-chart">
                                <div id="horoscope-chart2" class="chart-container2">
                                    <p>Navamsa</p>
                                </div>
                                <p>Navamsa</p>
                            </div>
                        </div>
                        <div class="kundali-img-res">
                            <div id="horoscope-chart1" class="chart-container1">
                            </div>
                            <div id="horoscope-chart2" class="chart-container2" style="display: none;">
                            </div>
                        </div>
                    </div>

                    <!-- Buttons to toggle -->
                    <div class="chart-toggle-buttons">
                        <button id="lagna-btn" class="active" onclick="showChart('lagna')">Lagna</button>
                        <button id="navamsa-btn" onclick="showChart('navamsa')">Navamsa</button>
                        <!-- <button><a href="gochar.html">Gochar</a></button>
                            <button><a href="aspectratio.html">Aspect Ratio</a></button>
                            <button><a href="birthchart.html">Birth Chart</a></button> -->
                    </div>
                    <!-- <div class="chart-toggle-buttons2"> -->
                    <!-- <button><a href="consonantvedh.html">Consonant Vedh</a></button>
                            <button><a href="dayvedh.html">Day Vedh</a></button>
                            <button><a href="frontvedh.html">Front Vedh</a></button>
                            <button><a href="lifeaspect.html">Life aspect</a></button>
                            <button><a href="lifeaspectwithpada.html">Life aspect(pada)</a></button>
                            <button><a href="rashi.html">Rashi</a></button> -->
                    <!-- <button><a href="monthlypunchang.html">Monthly Punchang</a></button> -->
                    <!-- <button><a href="tableofday.html">Table of Day</a></button> -->
                    <!-- <button><a href="tithi.html">Tithi</a></button>
                            <button><a href="profiledet.html">Profile Detail</a></button>
                            <button><a href="rashiplanetposition.html">Rashi Planet</a></button>
                            <button><a href="nakshatraPlanetPosition.html">Nakshatra Planet</a></button> -->
                    <!-- </div> -->
                </div>
            </div>

            <style>
                /* @media all and (min-width: 320px) and (max-width: 767px) {
                        .chart-toggle-buttons {
                            position: absolute;
                            bottom: -60px;
                            left: 33%;
                            transform: translateX(-50%);
                            display: flex !important;
                            gap: 10px;
                        }
    
                        .kundali-img-nres {
                            display: none !important;
                        }
                    } */

                .kundali-container h5 {
                    margin-bottom: 1rem;
                    text-align: center;
                }

                .kundli-chart p {
                    text-align: center;
                }

                .kundali-img-nres {
                    display: flex;
                    align-items: center;
                    gap: 2rem;
                }

                .kundali-img-res {
                    display: none !important;
                }

                .kundali-img-bx {

                    position: relative;
                    margin-bottom: 8rem;
                }

                .chart-toggle-buttons {
                    display: none;
                }

                .kundli-img {
                    display: flex;
                    align-items: center;
                    justify-content: space-around;
                    position: relative;
                    width: 100%;
                }

                .chart-toggle-buttons2 {
                    display: grid;
                    grid-template-columns: repeat(5, 1fr);
                    gap: 10px;
                    width: 100%;
                    max-width: 110rem;
                    margin: 0px auto;
                    margin: 2rem 0;
                }

                .chart-toggle-buttons button,
                .chart-toggle-buttons2 button {
                    padding: 10px 20px;
                    border: none;
                    cursor: pointer;
                    background-color: #f0f0f0;
                    font-size: 16px;
                    border-radius: 5px;
                    transition: background-color 0.3s ease;
                }

                .chart-toggle-buttons button.active,
                .chart-toggle-buttons2 button.active {
                    background-color: #fe7000;
                    color: white;
                }

                .kundli-img svg {
                    width: 100%;
                    height: 100%;
                }

                .gochara-house {
                    display: flex;
                    flex-direction: column;
                }

                .gochara-house-btn {
                    margin-top: 1rem;
                    padding: 10px 20px;
                    border: none;
                    cursor: pointer;
                    font-size: 16px;
                    border-radius: 5px;
                    transition: background-color 0.3s ease;
                    background-color: #fe7000;
                    color: white;
                }

                .btn {
                    padding: 10px 15px;
                    margin: 5px;
                    border: none;
                    cursor: pointer;
                    background-color: lightgray;
                    transition: 0.3s;
                }

                .active {
                    background-color: blue;
                    color: white;
                }

                .section {
                    display: none;
                    /* Hide all sections initially */
                }

                .visible {
                    display: block;
                    /* Show active section */
                }

                .house-factors-selc-bx {
                    margin-bottom: 2rem;
                }
            </style>
            <div class="chart-toggle-buttons2">
                <button class="btn active" onclick="setActive(0)">Planet</button>
                <button class="btn" onclick="setActive(1)">House</button>
                <button class="btn" onclick="setActive(2)">Dasa</button>
                <button class="btn" onclick="setActive(3)">Panchang</button>
                <button class="btn" onclick="setActive(4)">Gochar</button>
            </div>

            <div class="table-data">
                <div id="planet-section" class="section visible">
                    <table>
                        <thead>
                            <tr>
                                <th>Planet</th>
                                <th>R</th>
                                <th>C</th>
                                <th>Zodiac</th>
                                <th>House</th>
                                <th>Nakshatra Lord</th>
                                <th>Nakshatra</th>
                                <th>Pada</th>
                                <th>Zodiac Lord</th>
                                <th>Latitude</th>

                            </tr>
                        </thead>
                        <tbody id="planet-data"></tbody>
                    </table>
                </div>
                <!-- House data Here -->
                <div id="house-section" class="section">
                    <div class="house-factors-selc-bx">
                        <div class="house-fact-sel-bx">
                            <label for="houses">Houses</label>
                            <select id="houseDropdown">
                                <option value="1" selected>House 1</option>
                                <option value="2">House 2</option>
                                <option value="3">House 3</option>
                                <option value="4">House 4</option>
                                <option value="5">House 5</option>
                                <option value="6">House 6</option>
                                <option value="7">House 7</option>
                                <option value="8">House 8</option>
                                <option value="9">House 9</option>
                                <option value="10">House 10</option>
                                <option value="11">House 11</option>
                                <option value="12">House 12</option>
                            </select>
                        </div>

                        <div class="house-fact-sel-bx">
                            <label for="factors">Nature</label>
                            <select id="rashiNakSelect">
                                <option value="Rashi" selected>Rashi</option>
                                <option value="Nakshatra">Nakshatra</option>
                            </select>
                        </div>
                        <div class="house-fact-sel-bx">
                            <label for="factors">Divisional Chart</label>
                            <select id="divisionalSelect">
                                <option value="D1" selected>D1 - Lagna</option>
                                <option value="D2">D2</option>
                                <option value="D3">D3</option>
                                <option value="D3-s">D3-s</option>
                                <option value="D4">D4</option>
                                <option value="D5">D5</option>
                                <option value="D7">D7</option>
                                <option value="D8">D8</option>
                                <option value="D9">D9</option>
                                <option value="D10">D10</option>
                                <option value="D10-R">D10-R</option>
                                <option value="D12">D12</option>
                                <option value="D16">D16</option>
                                <option value="D20">D20</option>
                                <option value="D24">D24</option>
                                <option value="D24-R">D24-R</option>
                                <option value="D27">D27</option>
                                <option value="D30">D30</option>
                                <option value="D40">D40</option>
                                <option value="D45">D45</option>
                                <option value="D60">D60</option>
                            </select>
                        </div>

                    </div>

                    <div class="common-container3">

                        <div class="table-data">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Nakshatra(Pada)</th>
                                        <th>Rashi</th>
                                        <th>Planets </th>
                                        <th>Nature</th>
                                        <th>Dasha</th>
                                    </tr>
                                </thead>
                                <tbody data-table="positive" class="tableBody showtablebody" id="thirdTable">
                                </tbody>
                            </table>
                            <h6 style="margin: 2rem 0 1rem 0;">Planet Aspect</h6>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Nakshatra(Pada)</th>
                                        <th>Rashi</th>
                                        <th>Planets </th>
                                        <th>Nature</th>
                                        <th>Dasha</th>
                                    </tr>
                                </thead>
                                <tbody data-table="positive" class="tableBody showtablebody" id="fourthTable">
                                </tbody>
                            </table>
                            <h6 style="margin: 2rem 0 1rem 0;">Gochar</h6>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Nakshatra(Pada)</th>
                                        <th>Rashi</th>
                                        <th>Planets </th>
                                        <th>Nature</th>
                                        <th>Dasha</th>
                                        <th>Gochar</th>
                                    </tr>
                                </thead>
                                <tbody data-table="positive" class="tableBody showtablebody" id="fifthTable">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Dasa Details Section -->
                <div id="dasa-section" class="section">
                    <table>
                        <thead>
                            <tr>
                                <th colspan="10" style="text-align: center; font-weight: bold; margin-top: 2rem;">
                                    Dasa Details
                                </th>
                            </tr>
                        </thead>
                        <tbody id="dasa-data"></tbody>
                    </table>

                    <div class="cards-grid grid grid-two-col grid-gap">
                        <div class="kundali-dashaCards">
                            <h6>Maha Dasha</h6>
                            <p><strong>Dasha Remaining:</strong> <span id="dasha_remaining"></span></p>
                            <p><strong>Dasha Start Date:</strong> <span id="dasha_start_date"></span></p>
                            <p><strong>Start Year:</strong> <span id="start_year"></span></p>

                            <table>
                                <thead>
                                    <tr>
                                        <th>Planet</th>
                                        <th>Mahadasha Order</th>
                                    </tr>
                                </thead>
                                <tbody id="dashaTableBody"></tbody>
                            </table>
                        </div>
                        <div class="kundali-dashaCards">

                            <h6>Char Dasha</h6>
                            <p><strong>Start Date:</strong> <span id="startDate"></span></p>

                            <table>
                                <thead>
                                    <tr>
                                        <th>Zodiac Sign</th>
                                        <th>Dasha End Date</th>
                                    </tr>
                                </thead>
                                <tbody id="charDashaTableBody"></tbody>
                            </table>
                        </div>
                        <div class="kundali-dashaCards">
                            <h6>Antar Dasha</h6>

                            <table>
                                <thead>
                                    <tr>
                                        <th>Planet</th>
                                        <th>Antardasha Order</th>
                                    </tr>
                                </thead>
                                <tbody id="antardashaTableBody"></tbody>
                            </table>
                        </div>

                        <div class="kundali-dashaCards">
                            <h6>Yogini Dasha</h6>
                            <p><strong>Start Date:</strong> <span id="yoginistartDate"></span></p>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Yogini Dasha</th>
                                        <th>Yogini Lord</th>
                                        <th>End Date</th>
                                    </tr>
                                </thead>
                                <tbody id="yoginiDashaTableBody"></tbody>
                            </table>
                        </div>

                    </div>
                    <div class="kundali-dashaCards">
                        <h6>Char Dasha sub</h6>
                        <table>
                            <thead>
                                <tr>
                                    <th>Main Dasha</th>
                                    <th>Main Dasha Lord</th>
                                    <th>Sub Dasha</th>
                                    <th>Sub Dasha Start Date</th>
                                    <th>Sub Dasha End Date</th>
                                </tr>
                            </thead>
                            <tbody id="charSubDashaTableBody"></tbody>
                        </table>
                    </div>
                    <div class="kundali-dashaCards">
                        <h6>Yogini Dasha Sub</h6>
                        <table>
                            <thead>
                                <tr>
                                    <th>Yogini Dasha</th>
                                    <th>Yogini Lord</th>
                                    <th>Sub Dasha</th>
                                    <th>Start Date</th>
                                    <th>End Date</th>
                                </tr>
                            </thead>
                            <tbody id="yoginiSubDashaTableBody"></tbody>
                        </table>
                    </div>
                    <div class="cards-grid grid grid-two-col grid-gap">
                        <div class="kundali-dashaCards">
                            <h6>Paryantar Dasha</h6>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Paryantardasha</th>
                                        <th>Date</th>
                                    </tr>
                                </thead>
                                <tbody id="paryantarDashaTableBody"></tbody>
                            </table>
                        </div>
                    </div>

                </div>

                <!-- Panchang Details Section -->
                <div id="panchang-section" class="section">
                    <table>
                        <thead>
                            <tr>
                                <th colspan="10" style="text-align: center; font-weight: bold; margin-top: 2rem;">
                                    Panchang Details
                                </th>
                            </tr>
                        </thead>
                        <tbody id="panchang-data"></tbody>
                    </table>
                </div>

                <!-- Gochar Details Section -->
                <div id="gochar-section" class="section">
                    <table id="gocharTable">
                        <thead>
                            <tr>
                                <th>Planet Name</th>
                                <th>Rashi</th>
                                <th>Nakshatra</th>
                                <th>Pada</th>
                                <th>Combust</th>
                                <th>Motion</th>
                                <th>Date of Entry</th>
                                <th>Date of Exit</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>




    <!-- ____________________________
          Our Footer Comp 
          -------------------- -->

    <footer class="footer-comp">
        <div class="common-container3">

            <div class="footer-flex-bx">

                <div class="left-footer-bx">

                    <div class="left-header-logo flex item-start gap">
                        <img src="./images/astrology.png" alt="" onclick="window.location.href='home.html'">

                        <h6>Astro Nivesh</h6>


                    </div>




                    <p>
                        Astro Nivesh is best astrology website for online Astrology predictions. Talk to Astrologer on
                        call and get answers to all your worries by seeing the future life through Astrology Kundli
                        Predictions from the best Astrologers from India. Get best future predictions related to
                        Marriage, love life, Career or Health over call, chat, query or report.
                    </p>

                </div>


                <div class="right-footer-bx">

                    <div class="footer-bx">
                        <h6>Corporate Info</h6>
                        <div class="footer-li">
                            <li><a href="aboutus.html">About Us</a></li>
                            <li><a href="contactus.html">Contact Us</a></li>
                            <li><a href="termsconditions.html">Terms & Conditions</a></li>
                            <li><a href="privacypolicy.html">Privacy Policy</a></li>
                            <!-- <li><a href="shippingpolicy.html">Shipping Policy</a></li> -->
                            <li><a href="refundpolicy.html">Refund Policy</a></li>
                        </div>
                    </div>


                    <div class="footer-bx">
                        <h6>Contact Info</h6>
                        <div class="footer-li">
                            <li><a href="#"> We are available 24x7 on chat support</a></li>
                            <li><a href="#">Email ID: contact@astronivesh.com</a></li>

                            <div class="soc-icons-flex">
                                <a href="#">
                                    <ion-icon name="logo-facebook"></ion-icon>
                                </a>
                                <a href="#">
                                    <ion-icon name="logo-instagram"></ion-icon>
                                </a>
                                <a href="#">
                                    <ion-icon name="logo-linkedin"></ion-icon>
                                </a>
                                <a href="#">
                                    <ion-icon name="logo-youtube"></ion-icon>
                                </a>
                            </div>

                        </div>
                    </div>


                </div>

            </div>

            <div class="copyright-bx">
                <p>Copyright 2025 Astro Nivesh (This website is owned and managed by Shriram Lalasaheb Magar) | All
                    Rights Reserved | Dev. By: <a href="https://digitaldezire.com/">Digital Dezire</a></p>
            </div>
            <div style="display: none;">
                <select id="divisional-select">
                    <option value="D1" selected>D1 - Lagna</option>
                    <option value="D2">D2</option>
                    <option value="D3">D3</option>
                    <option value="D3-s">D3-s</option>
                    <option value="D4">D4</option>
                    <option value="D5">D5</option>
                    <option value="D7">D7</option>
                    <option value="D8">D8</option>
                    <option value="D9">D9</option>
                    <option value="D10">D10</option>
                    <option value="D10-R">D10-R</option>
                    <option value="D12">D12</option>
                    <option value="D16">D16</option>
                    <option value="D20">D20</option>
                    <option value="D24">D24</option>
                    <option value="D24-R">D24-R</option>
                    <option value="D27">D27</option>
                    <option value="D30">D30</option>
                    <option value="D40">D40</option>
                    <option value="D45">D45</option>
                    <option value="D60">D60</option>
                </select>
            </div>
        </div>
    </footer>
    <script>
        function setActive(index) {
            let buttons = document.querySelectorAll(".btn");
            let sections = document.querySelectorAll(".section");

            // Remove active class from all buttons and hide all sections
            buttons.forEach(btn => btn.classList.remove("active"));
            sections.forEach(section => section.classList.remove("visible"));

            // Add active class to clicked button and show corresponding section
            buttons[index].classList.add("active");
            sections[index].classList.add("visible");
        }
    </script>
    <script>
        const host = "https://api.astronivesh.com";
        const token = localStorage.getItem("token");
        if (!token) {
            window.location.href = "./home.html";
        }
        const params = JSON.parse(localStorage.getItem('usercred'));
        async function fetchData() {
            try {
                const response = await fetch(`${host}/api/admindetail/all`);
                const data = await response.json();

                const api = data[0]?.apiKey || [];
                const apiKey = api[0]?.apiKey;
                // console.log(data,"data")

                if (!Array.isArray(data) || data.length === 0 || !data[0].gochar || !Array.isArray(data[0].gochar)) {
                    throw new Error("Invalid data format: 'gochar' is missing or not an array.");
                }

                let gocharData = data[0].gochar;
                // console.log(gocharData, "gocharData")
                const normalizeDate = (date) => new Date(date.getFullYear(), date.getMonth(), date.getDate());
                const today = normalizeDate(new Date());

                let filteredData = gocharData.filter(entry => {
                    const entryDate = normalizeDate(new Date(entry.date_of_entry));
                    const exitDate = normalizeDate(new Date(entry.date_of_exit));
                    return today >= entryDate && today <= exitDate;
                });

                filteredData = filteredData.reduce((unique, entry) => {
                    const exitDate = normalizeDate(new Date(entry.date_of_exit));

                    if (exitDate.getTime() === today.getTime()) {
                        unique[entry.planet_name] = entry;
                    } else if (!unique[entry.planet_name]) {
                        unique[entry.planet_name] = entry;
                    }

                    return unique;
                }, {});

                // Convert back to an array
                filteredData = Object.values(filteredData);

                const planetOrder = ["Ascendant", "Sun", "Moon", "Mars", "Mercury", "Jupiter", "Venus", "Saturn", "Rahu", "Ketu"];

                // Sort based on custom planet order
                filteredData.sort((a, b) => {
                    return planetOrder.indexOf(a.planet_name) - planetOrder.indexOf(b.planet_name);
                });
                // Populate the table
                const tableBody = document.querySelector("#gocharTable tbody");
                tableBody.innerHTML = "";

                filteredData.forEach(entry => {
                    const row = `<tr>
                <td>${entry.planet_name || "N/A"}</td>
                <td>${entry.rashi || "N/A"}</td>
                <td>${entry.nakshatra || "N/A"}</td>
                <td>${entry.pada || "N/A"}</td>
                <td>${entry.combust ? "Yes" : "No"}</td>
                <td>${entry.motion || "N/A"}</td>
                <td>${entry.date_of_entry || "N/A"}</td>
                <td>${entry.date_of_exit || "N/A"}</td>
            </tr>`;
                    tableBody.innerHTML += row;
                });

            } catch (error) {
                console.error("Error fetching data:", error);
            }
        }

        fetchData();
    </script>
    <script>
        // place search
        document.addEventListener("DOMContentLoaded", function () {
            const birthplaceInput = document.getElementById("birthplace");
            const suggestionsList = document.getElementById("suggestions");
            const latitudeInput = document.getElementById("latitude");
            const longitudeInput = document.getElementById("longitude");

            async function fetchPlaces(query) {
                const response = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${query}`);
                const data = await response.json();
                return data.map(place => ({
                    name: place.display_name,
                    lat: place.lat,
                    lon: place.lon
                }));
            }

            birthplaceInput.addEventListener("input", async function () {
                const query = birthplaceInput.value.trim();
                if (query.length < 3) {
                    suggestionsList.innerHTML = "";
                    return;
                }

                const places = await fetchPlaces(query);
                suggestionsList.innerHTML = "";

                places.forEach(place => {
                    const li = document.createElement("li");
                    li.textContent = place.name;
                    li.addEventListener("click", () => {
                        birthplaceInput.value = place.name;
                        latitudeInput.value = place.lat;
                        longitudeInput.value = place.lon;
                        suggestionsList.innerHTML = ""; // Clear suggestions
                        console.log(`Selected Place: ${place.name}, Lat: ${place.lat}, Lon: ${place.lon}`);
                    });
                    suggestionsList.appendChild(li);
                });
            });

            document.addEventListener("click", (event) => {
                if (!suggestionsList.contains(event.target) && event.target !== birthplaceInput) {
                    suggestionsList.innerHTML = "";
                }
            });
        });

        async function fetchAllData() {
            try {
                const response = await fetch(`${host}/api/auth/getuser`, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "auth-token": token
                    }
                });

                if (!response.ok) {
                    throw new Error("Failed to fetch data");
                }

                const data = await response.json();
                populateTable(data);
                populateName(data);
            } catch (error) {
                console.error("Error fetching data:", error);
            }
        }

        function populateTable(data) {
            const tableBody = document.getElementById("profile-body");
            tableBody.innerHTML = "";

            tableBody.innerHTML = `
            <div class="profile-desc">
                <h4>${data.name}</h4>
            </div>
             
            `
        }
        function populateName(data) {
            const tableBody = document.getElementById("profile-name");
            tableBody.innerHTML = "";

            tableBody.innerHTML = `
            <p>${data.name}</p>
             
            `
        }
        async function handleCreate(event) {
            event.preventDefault();
            const latitude = document.getElementById("latitude").value;
            const longitude = document.getElementById("longitude").value;

            const regInfo = document.querySelector(".reg-info");
            regInfo.style.display = "none";

            // loader
            const modal = document.querySelector(".signup-loader");
            modal.style.display = "block";
            // Collect form data
            const formData = new FormData(event.target);

            const customerData = {
                dob: formData.get("calendarInput"),
                birthtime: formData.get("timePicker"),
                birthplace: formData.get("birthplace"),
            };

            // console.log(customerData, "customerData");
            const data = customerData;
            let api = [];
            try {
                const response = await fetch(`${host}/api/admindetail/all`, {
                    method: "GET",
                    headers: {
                        "Content-Type": "application/json",
                    }
                });

                if (!response.ok) {
                    throw new Error("Failed to fetch API data");
                }

                const data = await response.json();
                api = data[0]?.apiKey || []; // Store fetched API key
                // console.log(api, "Fetched API key");
            } catch (error) {
                console.error("Error fetching API key:", error);
            }

            try {
                // console.log(data, "data")
                const birthtime = data.birthtime;
                // console.log(birthtime, "birthtime")
                const location = data.birthplace;
                function convertTo24HourTime(time12h) {
                    const match = time12h.match(/(\d+):(\d+) (\w+)/);
                    if (!match) return null; // Handle invalid format

                    let [_, hours, minutes, period] = match;
                    hours = parseInt(hours, 10);
                    minutes = parseInt(minutes, 10);

                    if (period.toUpperCase() === "PM" && hours !== 12) {
                        hours += 12; // Convert PM to 24-hour format
                    } else if (period.toUpperCase() === "AM" && hours === 12) {
                        hours = 0; // Convert 12 AM to 00
                    }

                    return { hours, minutes }; // Returning as an object
                }

                const time24 = convertTo24HourTime(birthtime);
                let timeformate24 = []

                if (time24) {
                    const formattedTime = `${String(time24.hours).padStart(2, '0')}:${String(time24.minutes).padStart(2, '0')}`;
                    // console.log(formattedTime, "formattedTime"); // Output: "17:32"
                    timeformate24 = formattedTime
                } else {
                    console.error("Invalid time format");
                }
                // console.log(timeformate24, "time24")
                const formattedDate = data.dob.split('-').reverse().join('/');
                // console.log(formattedDate,"formattedDate")
                // console.log(api[0]?.apiKey, "api")
                const apiKey = api[0]?.apiKey;
                const baseUrl = "https://api.vedicastroapi.com/v3-json";
                const lat = latitude;
                const lon = longitude;

                const params = {
                    api_key: apiKey,
                    dob: formattedDate,
                    tob: timeformate24,
                    lat,
                    lon,
                    location,
                    tz: 5.5,
                    lang: "en",
                    D1: "D1",
                    D9: "D9",
                };

                // console.log(params, "params")
                localStorage.setItem('usercred', JSON.stringify(params));
                const horoscopeUrl = `${baseUrl}/horoscope/planet-details?dob=${params.dob}&tob=${params.tob}&lat=${params.lat}&lon=${params.lon}&tz=${params.tz}&api_key=${params.api_key}&lang=${params.lang}`;
                const response2 = await fetch(horoscopeUrl);
                if (!response2.ok) throw new Error("Failed to fetch horoscope data.");
                const horoscopeData = await response2.json();
                // console.log(horoscopeData,"horoscopeData")

                const DashaUrl = `${baseUrl}/dashas/current-mahadasha?dob=${params.dob}&tob=${params.tob}&lat=${params.lat}&lon=${params.lon}&tz=${params.tz}&api_key=${params.api_key}&lang=${params.lang}`;
                const responseAll = await fetch(DashaUrl);
                if (!responseAll.ok) {
                    throw new Error("Failed to fetch Dasha data.");
                }

                const DashaData = await responseAll.json();
                const dashas = DashaData.response.order_of_dashas || [];

                const chart1 = `${baseUrl}/horoscope/chart-image?dob=${params.dob}&tob=${params.tob}&lat=${params.lat}&lon=${params.lon}&tz=${params.tz}&div=${params.D1}&color=%23ff3366&style=north&api_key=${params.api_key}&lang=${params.lang}`;
                const response3 = await fetch(chart1);
                const chart1Url = await response3.text();
                const chart2 = `${baseUrl}/horoscope/chart-image?dob=${params.dob}&tob=${params.tob}&lat=${params.lat}&lon=${params.lon}&tz=${params.tz}&div=${params.D9}&color=%23ff3366&style=north&api_key=${params.api_key}&lang=${params.lang}`;
                const response4 = await fetch(chart2);
                const chart2Url = await response4.text();

                // maha dasha
                const mahaDasha = `${baseUrl}/dashas/maha-dasha?dob=${params.dob}&tob=${params.tob}&lat=${params.lat}&lon=${params.lon}&tz=${params.tz}&api_key=${params.api_key}&lang=${params.lang}`
                const maharesponse = await fetch(mahaDasha);
                if (!maharesponse.ok) throw new Error("Failed to fetch maharesponse data.");
                const mahaDashaData = await maharesponse.json();

                // antar dasha
                const antarDasha = `${baseUrl}/dashas/antar-dasha?dob=${params.dob}&tob=${params.tob}&lat=${params.lat}&lon=${params.lon}&tz=${params.tz}&api_key=${params.api_key}&lang=${params.lang}`
                const antarresponse = await fetch(antarDasha);
                if (!antarresponse.ok) throw new Error("Failed to fetch maharesponse data.");
                const antarDashaData = await antarresponse.json();

                // char dasha
                const charDasha = `${baseUrl}/dashas/char-dasha-main?dob=${params.dob}&tob=${params.tob}&lat=${params.lat}&lon=${params.lon}&tz=${params.tz}&api_key=${params.api_key}&lang=${params.lang}`
                const charresponse = await fetch(charDasha);
                if (!charresponse.ok) throw new Error("Failed to fetch maharesponse data.");
                const charDashaData = await charresponse.json();

                // charsub dasha
                const charsubDasha = `${baseUrl}/dashas/char-dasha-sub?dob=${params.dob}&tob=${params.tob}&lat=${params.lat}&lon=${params.lon}&tz=${params.tz}&api_key=${params.api_key}&lang=${params.lang}`
                const charsubresponse = await fetch(charsubDasha);
                if (!charsubresponse.ok) throw new Error("Failed to fetch maharesponse data.");
                const charsubDashaData = await charsubresponse.json();

                // yoginiDasha dasha
                const yoginiDasha = `${baseUrl}/dashas/yogini-dasha-main?dob=${params.dob}&tob=${params.tob}&lat=${params.lat}&lon=${params.lon}&tz=${params.tz}&api_key=${params.api_key}&lang=${params.lang}`
                const yoginiresponse = await fetch(yoginiDasha);
                if (!yoginiresponse.ok) throw new Error("Failed to fetch maharesponse data.");
                const yoginiDashaData = await yoginiresponse.json();

                // yoginiDashasub dasha
                const yoginisubDasha = `${baseUrl}/dashas/yogini-dasha-sub?dob=${params.dob}&tob=${params.tob}&lat=${params.lat}&lon=${params.lon}&tz=${params.tz}&api_key=${params.api_key}&lang=${params.lang}`
                const yoginisubresponse = await fetch(yoginisubDasha);
                if (!yoginisubresponse.ok) throw new Error("Failed to fetch maharesponse data.");
                const yoginisubDashaData = await yoginisubresponse.json();

                // char paryantarDasha
                const paryantarDasha = `${baseUrl}/dashas/paryantar-dasha?dob=${params.dob}&tob=${params.tob}&lat=${params.lat}&lon=${params.lon}&tz=${params.tz}&api_key=${params.api_key}&lang=${params.lang}`
                const paryantarresponse = await fetch(paryantarDasha);
                if (!paryantarresponse.ok) throw new Error("Failed to fetch maharesponse data.");
                const paryantarDashaData = await paryantarresponse.json();

                let rashiData = {};

                try {
                    const divisionalSelect = document.getElementById("divisional-select");
                    const divisions = Array.from(divisionalSelect.options).map(opt => opt.value);

                    for (const div of divisions) {
                        const divisionalUrl = `${baseUrl}/horoscope/divisional-charts?dob=${params.dob}&tob=${params.tob}&lat=${params.lat}&lon=${params.lon}&tz=${params.tz}&div=${div}&api_key=${params.api_key}&lang=${params.lang}&response_type=planet_object`;

                        try {
                            const response = await fetch(divisionalUrl);
                            if (!response.ok) {
                                console.warn(`Failed to fetch data for ${div}`);
                                continue; // Skip this division if there's an error
                            }

                            const horoscopeData = await response.json();
                            if (horoscopeData && horoscopeData.response) {
                                const mapPlanetData = (data) => {
                                    if (Array.isArray(data)) {
                                        return data.map((planet) => ({
                                            name: planet.full_name,
                                            zodiac: planet.zodiac,
                                            house: planet.house,
                                            retro: planet.retro,
                                            rasi_no: planet.rasi_no,
                                            local_degree: planet.local_degree,
                                        }));
                                    } else if (typeof data === "object" && data !== null) {
                                        return Object.values(data).map((planet) => ({
                                            name: planet.full_name,
                                            zodiac: planet.zodiac,
                                            house: planet.house,
                                            retro: planet.retro,
                                            rasi_no: planet.rasi_no,
                                            local_degree: planet.local_degree,
                                        }));
                                    } else {
                                        console.error(`Unexpected data format for ${div}:`, data);
                                        return [];
                                    }
                                };

                                rashiData[div] = mapPlanetData(horoscopeData.response).slice(0, 10);
                            } else {
                                console.warn(`Invalid or missing data for ${div}`);
                            }
                        } catch (error) {
                            console.error(`Error fetching horoscope data for ${div}:`, error);
                        }
                    }
                } catch (error) {
                    console.log("error")
                }
                let FreeKundali = {
                    horoscopeData, dashas, rashiData, chart1Url, chart2Url, mahaDashaData, antarDashaData, charDashaData, charsubDashaData, yoginiDashaData, yoginisubDashaData, paryantarDashaData
                }
                const nakshatraPadas = [];
                const nakshatras = [
                    "Ashvini", "Bharani", "Krittika", "Rohini", "Mrigashira", "Ardra",
                    "Punarvasu", "Pushya", "Ashlesha", "Magha", "PurvaPhalguni", "UttaraPhalguni",
                    "Hasta", "Chitra", "Svati", "Vishakha", "Anuradha", "Jyeshtha", "Mula",
                    "PurvaShadha", "UttraShadha", "Sravana", "Dhanista", "Shatabhisha",
                    "PurvaBhadra", "UttaraBhadra", "Revati"
                ];

                const rashis = [
                    "Aries", "Taurus", "Gemini", "Cancer", "Leo", "Virgo", "Libra", "Scorpio",
                    "Sagittarius", "Capricorn", "Aquarius", "Pisces"
                ];

                const zodiacMap = {
                    Aries: 1,
                    Taurus: 2,
                    Gemini: 3,
                    Cancer: 4,
                    Leo: 5,
                    Virgo: 6,
                    Libra: 7,
                    Scorpio: 8,
                    Sagittarius: 9,
                    Capricorn: 10,
                    Aquarius: 11,
                    Pisces: 12,
                };
                const planets = ["Sun", "Moon", "Mars", "Mercury", "Jupiter", "Venus", "Saturn", "Rahu", "Ketu"];
                const ucchaNeechaData = {
                    "Sun": { exalted: "Aries", debilitated: "Libra" },
                    "Moon": { exalted: "Taurus", debilitated: "Scorpio" },
                    "Mars": { exalted: "Capricorn", debilitated: "Cancer" },
                    "Mercury": { exalted: "Virgo", debilitated: "Pisces" },
                    "Jupiter": { exalted: "Cancer", debilitated: "Capricorn" },
                    "Venus": { exalted: "Pisces", debilitated: "Virgo" },
                    "Saturn": { exalted: "Libra", debilitated: "Aries" },
                    "Rahu": { exalted: "Gemini", debilitated: "Sagittarius" },
                    "Ketu": { exalted: "Sagittarius", debilitated: "Gemini" }
                };

                const planetaryRelations = {
                    "Sun": { friends: ["Moon", "Mars", "Jupiter"], enemies: ["Venus", "Saturn"] },
                    "Moon": { friends: ["Sun", "Mercury"], enemies: ["Rahu", "Ketu"] },
                    "Mars": { friends: ["Sun", "Moon", "Jupiter"], enemies: ["Mercury"] },
                    "Mercury": { friends: ["Sun", "Venus"], enemies: ["Moon", "Mars"] },
                    "Jupiter": { friends: ["Sun", "Moon", "Mars"], enemies: ["Venus", "Mercury"] },
                    "Venus": { friends: ["Mercury", "Saturn"], enemies: ["Sun", "Moon"] },
                    "Saturn": { friends: ["Venus", "Mercury"], enemies: ["Sun", "Moon", "Mars"] },
                    "Rahu": { friends: ["Venus", "Saturn", "Mercury"], enemies: ["Sun", "Moon", "Mars"] },
                    "Ketu": { friends: ["Saturn"], enemies: ["Sun", "Moon"] }
                };

                const rashiLords = {
                    "Aries": "Mars", "Taurus": "Venus", "Gemini": "Mercury", "Cancer": "Moon",
                    "Leo": "Sun", "Virgo": "Mercury", "Libra": "Venus", "Scorpio": "Mars",
                    "Sagittarius": "Jupiter", "Capricorn": "Saturn", "Aquarius": "Saturn", "Pisces": "Jupiter"
                };

                const nakshatraLords = {
                    "Ashvini": "Ketu", "Bharani": "Venus", "Krittika": "Sun", "Rohini": "Moon",
                    "Mrigashira": "Mars", "Ardra": "Rahu", "Punarvasu": "Jupiter", "Pushya": "Saturn",
                    "Ashlesha": "Mercury", "Magha": "Ketu", "Purva Phalguni": "Venus", "UttaraPhalguni": "Sun",
                    "Hasta": "Moon", "Chitra": "Mars", "Svati": "Rahu", "Vishakha": "Jupiter",
                    "Anuradha": "Saturn", "Jyeshtha": "Mercury", "Mula": "Ketu", "PurvaShadha": "Venus",
                    "UttraShadha": "Sun", "Sravana": "Moon", "Dhanista": "Mars", "Shatabhisha": "Rahu",
                    "PurvaBhadra": "Jupiter", "UttaraBhadra": "Saturn", "Revati": "Mercury"
                };

                const ucchaNeechaDegrees = {
                    "Sun": { exalted: { nakshatra: "Bharani", pada: 2 }, debilitated: { nakshatra: "Svati", pada: 1 } },
                    "Moon": { exalted: { nakshatra: "Krittika", pada: 1 }, debilitated: { nakshatra: "Anuradha", pada: 4 } },
                    "Mars": { exalted: { nakshatra: "Dhanista", pada: 1 }, debilitated: { nakshatra: "Pushya", pada: 4 } },
                    "Mercury": { exalted: { nakshatra: "UttaraPhalguni", pada: 4 }, debilitated: { nakshatra: "UttaraBhadra", pada: 2 } },
                    "Jupiter": { exalted: { nakshatra: "Punarvasu", pada: 4 }, debilitated: { nakshatra: "Dhanista", pada: 2 } },
                    "Venus": { exalted: { nakshatra: "UttaraBhadra", pada: 4 }, debilitated: { nakshatra: "UttaraPhalguni", pada: 2 } },
                    "Saturn": { exalted: { nakshatra: "Svati", pada: 3 }, debilitated: { nakshatra: "Ashvini", pada: 4 } },
                    "Rahu": { exalted: { nakshatra: "Rohini", pada: 2 }, debilitated: { nakshatra: "Jyeshtha", pada: 1 } },
                    "Ketu": { exalted: { nakshatra: "Jyeshtha", pada: 4 }, debilitated: { nakshatra: "Rohini", pada: 3 } }
                };

                const planetaryRelations2 = {
                    "Sun": { friends: ["Moon", "Mars", "Jupiter"], enemies: ["Venus", "Saturn"] },
                    "Moon": { friends: ["Sun", "Mercury"], enemies: ["Rahu", "Ketu"] },
                    "Mars": { friends: ["Sun", "Moon", "Jupiter"], enemies: ["Mercury"] },
                    "Mercury": { friends: ["Sun", "Venus"], enemies: ["Moon", "Mars"] },
                    "Jupiter": { friends: ["Sun", "Moon", "Mars"], enemies: ["Venus", "Mercury"] },
                    "Venus": { friends: ["Mercury", "Saturn"], enemies: ["Sun", "Moon"] },
                    "Saturn": { friends: ["Venus", "Mercury"], enemies: ["Sun", "Moon", "Mars"] },
                    "Rahu": { friends: ["Venus", "Saturn", "Mercury"], enemies: ["Sun", "Moon"] },
                    "Ketu": { friends: ["Mars", "Venus", "Saturn"], enemies: ["Sun", "Moon"] }
                };
                async function fetchUserData() {
                    try {
                        const response = await fetch(`${host}/api/detail/fetchalldetail`, {
                            method: "GET",
                            headers: {
                                "Content-Type": "application/json",
                                "auth-token": token
                            }
                        });

                        const response2 = await fetch(`${host}/api/admindetail/all`);
                        const data = await response2.json();

                        if (!Array.isArray(data) || data.length === 0 || !data[0].gochar || !Array.isArray(data[0].gochar)) {
                            throw new Error("Invalid data format: 'gochar' is missing or not an array.");
                        }

                        let filteredData = data[0].gochar;
                // console.log(gocharData, "gocharData")
                const normalizeDate = (date) => new Date(date.getFullYear(), date.getMonth(), date.getDate());
                const today = normalizeDate(new Date());

                let gocharData = filteredData.filter(entry => {
                    const entryDate = normalizeDate(new Date(entry.date_of_entry));
                    const exitDate = normalizeDate(new Date(entry.date_of_exit));
                    return today >= entryDate && today <= exitDate;
                });

                gocharData = gocharData.reduce((unique, entry) => {
                    const exitDate = normalizeDate(new Date(entry.date_of_exit));

                    if (exitDate.getTime() === today.getTime()) {
                        unique[entry.planet_name] = entry;
                    } else if (!unique[entry.planet_name]) {
                        unique[entry.planet_name] = entry;
                    }

                    return unique;
                }, {});

                        // Convert back to an array
                        filteredData = Object.values(filteredData);
                        initializeData(FreeKundali, gocharData)
                    } catch (error) {
                        console.error("Error fetching data:", error);
                    }
                }
                fetchUserData(FreeKundali)


                nakshatras.forEach((nakshatra, index) => {
                    for (let pada = 1; pada <= 4; pada++) {
                        const rashiIndex = Math.floor((index * 4 + (pada - 1)) / 9) % 12;
                        nakshatraPadas.push({ nakshatra, pada, rashi: rashis[rashiIndex] });
                    }
                });

                function getStatus(planet, rashi) {
                    const exaltedSign = ucchaNeechaData[planet]?.exalted;
                    const debilitatedSign = ucchaNeechaData[planet]?.debilitated;

                    if (rashi === exaltedSign) return "Uccha (Exalted)";
                    if (rashi === debilitatedSign) return "Neecha (Debilitated)";

                    const rashiLord = rashiLords[rashi];
                    const friends = planetaryRelations[planet]?.friends || [];
                    const enemies = planetaryRelations[planet]?.enemies || [];

                    if (rashiLord === planet) return "Own";
                    if (friends.includes(rashiLord)) return "Mitra (Friend)";
                    if (enemies.includes(rashiLord)) return "Shatru (Enemy)";

                    return "Neutral";
                }

                const position = []; // Store objects in an array
                function displayAllStatuses() {
                    planets.forEach(planet => {
                        // console.log(planet, "planets")
                        rashis.forEach(rashi => {
                            const status = getStatus(planet, rashi);
                            // console.log(status, "status")
                            position.push({
                                planet: planet,
                                rashi: rashi,
                                status: status
                            });
                        });
                    });
                }
                displayAllStatuses();
                // console.log(position, "position");

                // Nakshatra status
                function getStatusNak(planet, nakshatra, pada) {
                    const exalted = ucchaNeechaDegrees[planet].exalted;
                    const debilitated = ucchaNeechaDegrees[planet].debilitated;

                    if (nakshatra === exalted.nakshatra && pada === exalted.pada) return "Uccha (Exalted)";
                    if (nakshatra === debilitated.nakshatra && pada === debilitated.pada) return "Neecha (Debilitated)";

                    const nakshatraLord = nakshatraLords[nakshatra];
                    const friends = planetaryRelations2[planet].friends;
                    const enemies = planetaryRelations2[planet].enemies;

                    if (friends.includes(nakshatraLord)) return "Mitra (Friend)";
                    if (enemies.includes(nakshatraLord)) return "Shatru (Enemy)";

                    return "Neutral";
                }
                const nakshatraPosition = [];
                function displayStatus() {
                    planets.forEach(planet => {
                        nakshatras.forEach(nakshatra => {
                            for (let pada = 1; pada <= 4; pada++) {
                                const status = getStatusNak(planet, nakshatra, pada);

                                nakshatraPosition.push({
                                    planet: planet,
                                    nakshatra: nakshatra,
                                    pada: pada,
                                    status: status
                                });
                            }
                        });
                    })
                }
                displayStatus();
                async function initializeData(FreeKundali, gocharData, selectedHouse = "1") {
                    console.log(FreeKundali, "data");
                    let GocharData = gocharData;
                    let horoscopeData = FreeKundali.horoscopeData || [];
                    let dashas = FreeKundali.dashas || [];
                    let rashiData = FreeKundali.rashiData || [];
                    let chart1Url = FreeKundali.chart1Url || [];
                    let chart2Url = FreeKundali.chart2Url || [];
                    let mahaDashaData = FreeKundali.mahaDashaData || [];
                    let antarDashaData = FreeKundali.antarDashaData || [];
                    let charDashaData = FreeKundali.charDashaData || [];
                    let charsubDashaData = FreeKundali.charsubDashaData || [];
                    let yoginiDashaData = FreeKundali.yoginiDashaData || [];
                    let yoginisubDashaData = FreeKundali.yoginisubDashaData || [];
                    let paryantarDashaData = FreeKundali.paryantarDashaData || [];

                    // Function to populate the table
                    const populateHouseTable = (selectedHouse = "1") => {
                        // const resultTable = document.getElementById("resultbody").querySelector("tbody");
                        // resultTable.innerHTML = "";

                        // Get horoscopeData from localStorage

                        let planets = [];

                        if (horoscopeData && horoscopeData.response) {
                            const planetDatas = horoscopeData.response;

                            const createHouses = (startZodiacNumber) => {
                                const houses = [];
                                let currentNumber = startZodiacNumber;
                                for (let i = 0; i < 12; i++) {
                                    houses.push(currentNumber);
                                    currentNumber = currentNumber === 12 ? 1 : currentNumber + 1;
                                }
                                return houses;
                            };

                            // Map Planet Data
                            const mapHPlanetData = (data) => {
                                if (Array.isArray(data)) {
                                    return data.map((planet) => ({
                                        name: planet.full_name,
                                        nakshatra: planet.nakshatra,
                                        pada: planet.nakshatra_pada,
                                        retro: planet.retro,
                                        is_combust: planet.is_combust,
                                        zodiac: planet.zodiac,
                                        zodiacNumber: zodiacMap[planet.zodiac] || "-",
                                        houses: createHouses(zodiacMap[planet.zodiac] || 1),
                                    }));
                                } else if (typeof data === "object" && data !== null) {
                                    return Object.values(data).map((planet) => ({
                                        name: planet.full_name,
                                        nakshatra: planet.nakshatra,
                                        pada: planet.nakshatra_pada,
                                        retro: planet.retro,
                                        is_combust: planet.is_combust,
                                        zodiac: planet.zodiac,
                                        zodiacNumber: zodiacMap[planet.zodiac] || "-",
                                        houses: createHouses(zodiacMap[planet.zodiac] || 1),
                                    }));
                                } else {
                                    console.error("Unexpected data format for planets:", data);
                                    return [];
                                }
                            };

                            planets = mapHPlanetData(planetDatas).slice(0, 10);
                        }

                        const defaultNakshatra = planets[0]?.nakshatra || "Ashvini";
                        const defaultPada = planets[0]?.pada || 1;

                        let currentIndex = nakshatraPadas.findIndex(
                            (n) => n.nakshatra === defaultNakshatra && n.pada === defaultPada
                        );

                        let currentIndex2 = nakshatraPadas.findIndex(
                            (n) => n.nakshatra === defaultNakshatra && n.pada === defaultPada
                        );


                        let storedPadas = [];
                        let comparisonData = []; // Store comparison data for use in resultTable


                        for (let house = 1; house <= 12; house++) {
                            currentIndex2 = (currentIndex2 + 9) % nakshatraPadas.length;

                            for (let i = 0; i < 10; i++) {
                                const padaIndex = (currentIndex2 + i) % nakshatraPadas.length;
                                const pada = nakshatraPadas[padaIndex];
                                storedPadas.push(nakshatraPadas[padaIndex]);
                            }
                        }
                        for (let house = 1; house <= 12; house++) {
                            if (selectedHouse !== "all" && house !== parseInt(selectedHouse, 10)) {
                                currentIndex = (currentIndex + 9) % nakshatraPadas.length;
                                continue;
                            }

                            const ascendant = planets[0];
                            const ascendantHouseValue = ascendant.houses[selectedHouse - 1];
                            // console.log(ascendant)


                            planets.forEach((planet) => {
                                // console.log(planet,"planet")
                                let oneHundredPercent = "-";
                                let seventyFivePercent = "-";
                                let fiftyPercent = "-";
                                let twentyFivePercent = "-";

                                if (selectedHouse === "5" || selectedHouse === "9") {
                                    let matchingPlanets = ["Jupiter", "Rahu", "Ketu"].filter(name => name === planet.name);
                                    if (matchingPlanets.length > 0) {
                                        oneHundredPercent = matchingPlanets.join(", ");
                                    }
                                }
                                if (selectedHouse === "4" || selectedHouse === "8") {
                                    let matchingPlanets = ["Mars"].filter(name => name === planet.name);
                                    if (matchingPlanets.length > 0) {
                                        oneHundredPercent = matchingPlanets.join(", ");
                                    }
                                }
                                if (selectedHouse === "3" || selectedHouse === "10") {
                                    let matchingPlanets = ["Saturn"].filter(name => name === planet.name);
                                    if (matchingPlanets.length > 0) {
                                        oneHundredPercent = matchingPlanets.join(", ");
                                    }
                                }
                                if (planet.houses[0] === ascendantHouseValue || planet.houses[6] === ascendantHouseValue) {
                                    oneHundredPercent = planet.name;
                                }
                                if (planet.houses[3] === ascendantHouseValue || planet.houses[7] === ascendantHouseValue) {
                                    seventyFivePercent = planet.name;
                                }
                                if (planet.houses[4] === ascendantHouseValue || planet.houses[8] === ascendantHouseValue) {
                                    fiftyPercent = planet.name;
                                }
                                if (planet.houses[2] === ascendantHouseValue || planet.houses[9] === ascendantHouseValue) {
                                    twentyFivePercent = planet.name;
                                }

                                // Save comparison data
                                comparisonData.push({
                                    name: planet.name,
                                    oneHundredPercent,
                                    seventyFivePercent,
                                    fiftyPercent,
                                    twentyFivePercent,
                                });
                            });


                            for (let i = 0; i < 9; i++) {
                                const padaIndex = (currentIndex + i) % nakshatraPadas.length;
                                const pada = nakshatraPadas[padaIndex];
                                // console.log(pada, "pada")

                                // Find all matching planets
                                const matchingPlanets = planets.filter(
                                    (planet) => planet.nakshatra === pada.nakshatra && planet.pada === pada.pada
                                );


                                let planetNames = matchingPlanets.length > 0 ? matchingPlanets.map((planet) => planet.name).join(", ") : "-";
                                let dashakeys = [];

                                matchingPlanets.forEach((planet) => {
                                    Object.entries(dashas).forEach(([key, value]) => {
                                        if (value.name === planet.name) {
                                            dashakeys.push(key, value);
                                        }
                                    });
                                });

                                const dashaText = dashakeys.length > 0 ? `(${dashakeys.join(", ")})` : "";
                                // console.log(dashakeys,"dashaText")

                                // Find planets with percentage matches
                                let oneHundredPercentNames = comparisonData
                                    .filter((data) => data.oneHundredPercent !== "-")
                                    .map((data) => data.oneHundredPercent);
                                let seventyFivePercentNames = comparisonData
                                    .filter((data) => data.seventyFivePercent !== "-")
                                    .map((data) => data.seventyFivePercent);
                                let fiftyPercentNames = comparisonData
                                    .filter((data) => data.fiftyPercent !== "-")
                                    .map((data) => data.fiftyPercent);
                                let twentyFivePercentNames = comparisonData
                                    .filter((data) => data.twentyFivePercent !== "-")
                                    .map((data) => data.twentyFivePercent);

                                const retroPlanets = matchingPlanets.filter((planet) => planet.retro).map(() => "R").join(", ");
                                const combustPlanets = matchingPlanets.filter((planet) => planet.is_combust).map(() => "C").join(", ");
                                comparisonData.push({
                                    pada: pada,
                                });
                            }

                            // console.log(comparisonData,"comparisonData")

                            // let planetTable = document.getElementById("planetTable");
                            // let matchedTable = document.getElementById("matchedTable");
                            let selectedDivisional = document.getElementById("divisionalSelect").value;
                            let selectedRasNak = document.getElementById("rashiNakSelect").value;

                            updateTable(comparisonData, storedPadas, position, nakshatraPosition);
                            function updateTable(comparisonData, padas, position, nakshatraPosition) {
                                let divisionalData = rashiData[selectedDivisional];
                                // console.log(rashiData, "rashiData")
                                // console.log(position, "position")
                                // console.log(nakshatraPosition, "nakshatraPosition")
                                // console.log(selectedRasNak, "selectedRasNak")
                                // console.log(comparisonData, "comparisonData")

                                // planetTable.innerHTML = ``;

                                let allMatchingPlanets = [];

                                if (padas && Array.isArray(padas)) {
                                    padas.forEach((pada) => {
                                        let matchingPlanets = planets.filter(
                                            (planet) => planet.nakshatra === pada.nakshatra && planet.pada === pada.pada
                                        );

                                        if (matchingPlanets.length > 0) {
                                            allMatchingPlanets.push(...matchingPlanets);
                                        }
                                    });
                                }

                                // Sorting function
                                comparisonData.sort((a, b) => {
                                    let getValue = (data) => {
                                        if (data.oneHundredPercent && data.oneHundredPercent !== "-") return 100;
                                        if (data.seventyFivePercent && data.seventyFivePercent !== "-") return 75;
                                        if (data.fiftyPercent && data.fiftyPercent !== "-") return 50;
                                        if (data.twentyFivePercent && data.twentyFivePercent !== "-") return 25;
                                        return 0;
                                    };

                                    // Sort by Nakshatra first (alphabetically)
                                    let nakshatraA = a.nakshatra || "";
                                    let nakshatraB = b.nakshatra || "";
                                    let nakshatraDiff = nakshatraA.localeCompare(nakshatraB);
                                    if (nakshatraDiff !== 0) return nakshatraDiff;

                                    // Sort by Pada (ascending order)
                                    let padaA = a.pada ? parseInt(a.pada) : 0;
                                    let padaB = b.pada ? parseInt(b.pada) : 0;
                                    if (padaA !== padaB) return padaA - padaB;

                                    // Sort by percentage (descending order)
                                    return getValue(b) - getValue(a);
                                });

                                let firstTableData = [];
                                let secondTableData = [];

                                comparisonData.forEach((data) => {
                                    // console.log(data, "data");
                                    let planetName = data.planetName && data.planetName !== "-" ? data.planetName : null;

                                    let hundred = data.oneHundredPercent && data.oneHundredPercent !== "-" ? data.oneHundredPercent : "";
                                    let seventyFive = data.seventyFivePercent && data.seventyFivePercent !== "-" ? data.seventyFivePercent : "";
                                    let fifty = data.fiftyPercent && data.fiftyPercent !== "-" ? data.fiftyPercent : "";
                                    let twentyFive = data.twentyFivePercent && data.twentyFivePercent !== "-" ? data.twentyFivePercent : "";

                                    let percentageText = "";
                                    if (!planetName) {
                                        if (hundred) {
                                            planetName = hundred;
                                            percentageText = " ";
                                        } else if (seventyFive) {
                                            planetName = seventyFive;
                                            percentageText = " 75%";
                                        } else if (fifty) {
                                            planetName = fifty;
                                            percentageText = " 50%";
                                        } else if (twentyFive) {
                                            planetName = twentyFive;
                                            percentageText = " 25%";
                                        } else {
                                            planetName = null;
                                        }
                                    } else {
                                        if (hundred === planetName) {
                                            percentageText = " ";
                                        } else if (seventyFive === planetName) {
                                            percentageText = " 75%";
                                        } else if (fifty === planetName) {
                                            percentageText = " 50%";
                                        } else if (twentyFive === planetName) {
                                            percentageText = " 25%";
                                        }
                                    }

                                    if (planetName) {
                                        if (planetName === "Ascendant" && selectedHouse !== "1") {
                                            return;
                                        }

                                        const matchedPlanet = allMatchingPlanets.find((p) => p.name === planetName);
                                        const retro = matchedPlanet?.retro;
                                        const combust = matchedPlanet?.is_combust;

                                        let retroPlanet = retro ? '&#8634;' : "";
                                        let combustPlanet = combust ? '&#128293;' : "";

                                        let matchedNakshatra = matchedPlanet?.nakshatra || "";
                                        let matchedPada = matchedPlanet?.pada || "";

                                        let matchedD = [];
                                        if (divisionalData) {
                                            matchedD = divisionalData.find((i) => i.name === planetName);
                                        }
                                        let matchedRashis = matchedD?.zodiac || "";

                                        let positionValue = [];
                                        let status = [];

                                        if (selectedRasNak === "Rashi") {
                                            positionValue = position.find((i) => i.planet === planetName && i.rashi === matchedRashis);

                                            if (positionValue?.status === "Uccha (Exalted)") {
                                                status = 'color-pos-bx1';
                                            } else if (positionValue?.status === "Own") {
                                                status = 'color-pos-bx2';
                                            } else if (positionValue?.status === "Mitra (Friend)") {
                                                status = 'color-pos-bx3';
                                            } else if (positionValue?.status === "Neutral") {
                                                status = 'color-pos-bx4';
                                            } else if (positionValue?.status === "Shatru (Enemy)") {
                                                status = 'color-pos-bx5';
                                            } else if (positionValue?.status === "Neecha (Debilitated)") {
                                                status = 'color-pos-bx6';
                                            }
                                        } else {
                                            positionValue = nakshatraPosition.find((i) => i.planet === planetName && i.nakshatra === matchedNakshatra && i.pada === matchedPada);

                                            if (positionValue?.status === "Uccha (Exalted)") {
                                                status = 'color-pos-bx1';
                                            } else if (positionValue?.status === "Mitra (Friend)") {
                                                status = 'color-pos-bx3';
                                            } else if (positionValue?.status === "Neutral") {
                                                status = 'color-pos-bx4';
                                            } else if (positionValue?.status === "Shatru (Enemy)") {
                                                status = 'color-pos-bx5';
                                            } else if (positionValue?.status === "Neecha (Debilitated)") {
                                                status = 'color-pos-bx6';
                                            }
                                        }

                                        // console.log(positionValue,"positionValue")

                                        let dashakeys = [];
                                        Object.entries(dashas).forEach(([key, value]) => {
                                            if (value.name === planetName) {
                                                dashakeys.push({ key, value });
                                            }
                                        });

                                        // let dashaText = dashakeys.length > 0 ? `(${dashakeys.join(", ")})` : "-";

                                        const dashaLabels = {
                                            major: "Mahadasha (MD)",
                                            minor: "Antardasha (AD)",
                                            sub_minor: "Pratyantar Dasha (PD)",
                                            sub_sub_minor: "Sookshma Dasha (SD)"
                                        };

                                        let dashaForms = dashakeys.map(({ key }) => dashaLabels[key] || key);

                                        // Extract actual dasha values (ensuring valid data)
                                        let dashaValues = dashakeys.map(({ value }) => value ? value : null).filter(Boolean);

                                        // Format outputs
                                        let dashaForm = dashaForms.length > 0 ? dashaForms.join(", ") : "-";
                                        let dashavalueForm = dashaValues.length > 0 ? dashaValues : "-";

                                        let dashaStart = dashaValues.length > 0 ? new Date(dashaValues[0].start).toISOString().split("T")[0] : "-";
                                        let dashaEnd = dashaValues.length > 0 ? new Date(dashaValues[0].end).toISOString().split("T")[0] : "-";

                                        // console.log(dashaStart, "dashaStart");
                                        // console.log(dashaEnd, "dashaEnd");


                                        // Store in an array
                                        firstTableData.push({
                                            nakshatra: matchedNakshatra,
                                            pada: matchedPada,
                                            rashi: matchedRashis,
                                            planet: planetName,
                                            positionValue: positionValue,
                                            status: status,
                                            percentageText: percentageText,
                                            retroPlanet: retroPlanet,
                                            combustPlanet: combustPlanet,
                                            dashaForm: dashaForm,
                                            dashaStart: dashaStart,
                                            dashaEnd: dashaEnd
                                        });

                                        // Append planet data row
                                        //                             const row = `
                                        //     <tr>
                                        //         <td class="td-span">
                                        //             <span>${matchedNakshatra}(${matchedPada})</span>
                                        //         </td>
                                        //         <td class="td-span">
                                        //             <span>${matchedRashis}</span>
                                        //         </td>
                                        //         <td class="td-span">
                                        //             <span>${planetName} ${percentageText} ${retroPlanet} ${combustPlanet}</span>
                                        //         </td>
                                        //         <td class="td-span">
                                        //             <div class="color-bx ${status}" data-tooltip="${positionValue?.status ? positionValue.status : ''}"></div>
                                        //         </td>
                                        //         <td class="td-span">
                                        //             <span>${dashaForm}</span>
                                        //         </td>
                                        //     </tr>
                                        // `;

                                        //                             planetTable.innerHTML += row;
                                    }
                                });

                                // ADD PADA DETAILS EVEN IF NO PLANETS MATCH
                                comparisonData.forEach((data) => {
                                    // console.log(data, "data");

                                    let planetName = data.planetName && data.planetName !== "-" ? data.planetName : null;

                                    let matchedPadas = data.pada?.pada || "";
                                    let matchedNakshatras = data.pada?.nakshatra || "";
                                    let matchedRashi = data.pada?.rashi || "";
                                    if (matchedPadas) {
                                        secondTableData.push({
                                            nakshatra: matchedNakshatras,
                                            pada: matchedPadas,
                                            rashi: matchedRashi
                                        });
                                        //                                 const row = `
                                        // <tr>
                                        // <td class="td-span"><span>${matchedNakshatras}(${matchedPadas})</span></td>
                                        // <td class="td-span"><span>${matchedRashi}</span></td>
                                        // <td class="td-span"><span>${planetName || "-"}</span></td>
                                        // <td class="td-span"><span>-</span></td>
                                        // <td class="td-span"><span>-</span></td>
                                        // </tr>
                                        // `;

                                        //                                 planetTable.innerHTML += row;
                                    }

                                });
                                // Compare and generate the third table
                                let thirdTableContent = "";
                                let fourthTableContent = "";
                                let fifthTableContent = "";
                                let matchedNakshatras = new Set();
                                let matchedPlanets = new Set(); // Track planets added to the third table

                                secondTableData.forEach((entry2) => {
                                    let matches = firstTableData.filter(entry1 => entry1.nakshatra === entry2.nakshatra);
                                    let matchPlanetsList = matches.filter((i) => i.pada === entry2.pada);
                                    // console.log(matches, "matches")
                                    // console.log(matchPlanetsList,"matchPlanetsList")

                                    // Extract and join all matching planet-related values
                                    let planetsText = matchPlanetsList.map(mp => mp.planet).join(", ");
                                    let percentageText = matchPlanetsList.map(mp => mp.percentageText).join(", ");
                                    let retroPlanets = matchPlanetsList.map(mp => mp.retroPlanet).join(", ");
                                    let combustPlanets = matchPlanetsList.map(mp => mp.combustPlanet).join(", ");
                                    let statusClass = matchPlanetsList.length > 0 ? matchPlanetsList[0].status : "-";
                                    let positionStatus = matchPlanetsList.length > 0 ? matchPlanetsList[0].positionValue : "-";
                                    let dashaform2 = matchPlanetsList.length > 0 ? matchPlanetsList[0].dashaForm : "-"
                                    let dashaformStart = matchPlanetsList.length > 0 ? matchPlanetsList[0].dashaStart : "-"
                                    let dashaformEnd = matchPlanetsList.length > 0 ? matchPlanetsList[0].dashaEnd : "-"

                                    if (!planetsText) {
                                        const planetText2 = planets.find(j => j.nakshatra === entry2.nakshatra && j.pada === entry2.pada);
                                        planetsText = planetText2 ? planetText2.name : "";
                                        retroPlanets = planetText2?.retro === true ? '&#8634;' : "";
                                        combustPlanets = planetText2?.is_combust === true ? '&#128293;' : "";

                                        let matchedD = [];
                                        if (divisionalData) {
                                            matchedD = divisionalData.find((i) => i.name === planetText2?.name);
                                        }
                                        // console.log(matchedD,"matchedD")
                                        let matchedRashis = matchedD?.zodiac || "";
                                        // console.log(matchedRashis,"matchedRashis")

                                        let positionValue = [];
                                        let status = [];

                                        if (selectedRasNak === "Rashi") {
                                            positionValue = position.find((i) => i.planet === planetText2?.name && i.rashi === matchedRashis);
                                            if (positionValue?.status === "Uccha (Exalted)") {
                                                status = 'color-pos-bx1';
                                            } else if (positionValue?.status === "Own") {
                                                status = 'color-pos-bx2';
                                            } else if (positionValue?.status === "Mitra (Friend)") {
                                                status = 'color-pos-bx3';
                                            } else if (positionValue?.status === "Neutral") {
                                                status = 'color-pos-bx4';
                                            } else if (positionValue?.status === "Shatru (Enemy)") {
                                                status = 'color-pos-bx5';
                                            } else if (positionValue?.status === "Neecha (Debilitated)") {
                                                status = 'color-pos-bx6';
                                            }
                                        } else {
                                            positionValue = nakshatraPosition.find((i) => i.planet === planetText2?.name && i.nakshatra === planetText2?.nakshatra && i.pada === planetText2?.pada);

                                            if (positionValue?.status === "Uccha (Exalted)") {
                                                status = 'color-pos-bx1';
                                            } else if (positionValue?.status === "Mitra (Friend)") {
                                                status = 'color-pos-bx3';
                                            } else if (positionValue?.status === "Neutral") {
                                                status = 'color-pos-bx4';
                                            } else if (positionValue?.status === "Shatru (Enemy)") {
                                                status = 'color-pos-bx5';
                                            } else if (positionValue?.status === "Neecha (Debilitated)") {
                                                status = 'color-pos-bx6';
                                            }
                                        }
                                        statusClass = status;
                                        positionStatus = positionValue;
                                        // console.log(status,"status")

                                        let dashakeys = [];
                                        Object.entries(dashas).forEach(([key, value]) => {
                                            if (value.name === planetText2?.name) {
                                                dashakeys.push({ key, value });
                                            }
                                        });

                                        // let dashaText = dashakeys.length > 0 ? `(${dashakeys.join(", ")})` : "-";

                                        const dashaLabels = {
                                            major: "Mahadasha (MD)",
                                            minor: "Antardasha (AD)",
                                            sub_minor: "Pratyantar Dasha (PD)",
                                            sub_sub_minor: "Sookshma Dasha (SD)"
                                        };

                                        let dashaForms = dashakeys.map(({ key }) => dashaLabels[key] || key);

                                        // Extract actual dasha values (ensuring valid data)
                                        let dashaValues = dashakeys.map(({ value }) => value ? value : null).filter(Boolean);

                                        // Format outputs
                                        let dashaForm = dashaForms.length > 0 ? dashaForms.join(", ") : "-";
                                        let dashavalueForm = dashaValues.length > 0 ? dashaValues : "-";

                                        let dashaStart = dashaValues.length > 0 ? new Date(dashaValues[0].start).toISOString().split("T")[0] : "-";
                                        let dashaEnd = dashaValues.length > 0 ? new Date(dashaValues[0].end).toISOString().split("T")[0] : "-";

                                        dashaform2 = dashaForm
                                        dashaformStart = dashaStart
                                        dashaformEnd = dashaEnd

                                    }
                                    // Add all matched planets to the set
                                    matchPlanetsList.forEach(mp => matchedPlanets.add(mp.planet));
                                    if (planetsText.includes("Ascendant")) {
                                        percentageText = " "
                                        retroPlanets = " "
                                        combustPlanets = " "
                                    }
                                    thirdTableContent += `
        <tr>
            <td class="td-span"><span>${entry2.nakshatra}(${entry2.pada})</span></td>
            <td class="td-span"><span>${entry2.rashi}</span></td>
            <td class="td-span"><span>${planetsText || "-"} ${percentageText ? percentageText : " "} ${retroPlanets ? retroPlanets : " "} ${combustPlanets ? combustPlanets : " "} </span></td>
            <td class="td-span">
                <div class="color-bx ${statusClass}" data-tooltip="${positionStatus?.status}"></div>
            </td>
            <td class="td-span">
                <span>${dashaform2 !== "-" && dashaform2 ?
                                            `${dashaform2} <i class="color-bx color-pos-bx4 fa-regular fa-eye mx-2" data-tooltip="${dashaformStart} - ${dashaformEnd}"></i>`
                                            : "-"}</span>
            </td>
        </tr>`;
                                });

                                // Find Nakshatras in Table 1 that are not in Table 2 and exclude matched planets
                                firstTableData.forEach(entry1 => {
                                    // console.log(entry1,"entry1")
                                    // console.log(entry1.dashavalueForm.find((i) => i.end),"end")
                                    if (!matchedNakshatras.has(entry1.nakshatra) && !matchedPlanets.has(entry1.planet)) {
                                        fourthTableContent += `
                                <tr>
                                    <td class="td-span"><span>${entry1.nakshatra}(${entry1.pada})</span></td>
                                    <td class="td-span"><span>${entry1.rashi}</span></td>
                                    <td class="td-span"><span>${entry1.planet || "-"} ${entry1?.percentageText || " "} ${entry1?.retroPlanet || " "} ${entry1?.combustPlanet || " "} </span></td>
                                    <td class="td-span">
                                        <div class="color-bx ${entry1?.status || "-"}" data-tooltip="${entry1?.positionValue?.status ? entry1?.positionValue.status : '-'}"></div>
                                    </td>
                                    <td class="td-span">
                                        <span data-tooltip="tooltips">
                                            ${entry1.dashaForm && entry1.dashaForm !== "-" ?
                                                `${entry1.dashaForm} <i class="color-bx color-pos-bx4 fa-regular fa-eye mx-2" class="fa-regular fa-eye mx-2" data-tooltip="${entry1.dashaStart} - ${entry1.dashaEnd}"></i>`
                                                : "-"} </span>
                                    </td>
                                </tr>`;
                                    }
                                });
                                // Find Nakshatras in Table 1 that are not in Table 2 and exclude matched planets
                                secondTableData.forEach(entry1 => {

                                    // console.log(entry1, "entry1")

                                    // console.log(GocharData,"gocharData")
                                    let matchGocharPlanet = GocharData.find((i) => i.nakshatra === entry1.nakshatra && i.pada === entry1.pada)
                                    // console.log(matchGocharPlanet, "matchGocharPlanet")

                                    if (matchGocharPlanet) {
                                        let positionValue = [];
                                        let status = [];

                                        if (selectedRasNak === "Rashi") {
                                            positionValue = position.find((i) => i.planet === matchGocharPlanet.planet_name && i.rashi === matchGocharPlanet.rashi);

                                            if (positionValue?.status === "Uccha (Exalted)") {
                                                status = 'color-pos-bx1';
                                            } else if (positionValue?.status === "Own") {
                                                status = 'color-pos-bx2';
                                            } else if (positionValue?.status === "Mitra (Friend)") {
                                                status = 'color-pos-bx3';
                                            } else if (positionValue?.status === "Neutral") {
                                                status = 'color-pos-bx4';
                                            } else if (positionValue?.status === "Shatru (Enemy)") {
                                                status = 'color-pos-bx5';
                                            } else if (positionValue?.status === "Neecha (Debilitated)") {
                                                status = 'color-pos-bx6';
                                            }
                                        } else {
                                            positionValue = nakshatraPosition.find((i) => i.planet === matchGocharPlanet.planet_name && i.nakshatra === matchGocharPlanet.nakshatra && i.pada === matchGocharPlanet.pada);

                                            if (positionValue?.status === "Uccha (Exalted)") {
                                                status = 'color-pos-bx1';
                                            } else if (positionValue?.status === "Mitra (Friend)") {
                                                status = 'color-pos-bx3';
                                            } else if (positionValue?.status === "Neutral") {
                                                status = 'color-pos-bx4';
                                            } else if (positionValue?.status === "Shatru (Enemy)") {
                                                status = 'color-pos-bx5';
                                            } else if (positionValue?.status === "Neecha (Debilitated)") {
                                                status = 'color-pos-bx6';
                                            }
                                        }
                                        fifthTableContent += `
    <tr>
        <td class="td-span"><span>${entry1.nakshatra}(${entry1.pada})</span></td>
        <td class="td-span"><span>${entry1.rashi}</span></td>
        <td class="td-span"><span>${matchGocharPlanet.planet_name || "-"}  ${matchGocharPlanet?.motion === "retrograde" ? "&#8634;" : " "} ${matchGocharPlanet?.combust === "true" ? "&#128293" : " "} </span></td>
        <td class="td-span">
            <div class="color-bx ${status || "-"}" data-tooltip="${positionValue?.status ? positionValue.status : '-'}"></div>
        </td>
        <td class="td-span">
            <span>${entry1?.dashaForm || "-"}</span>
        </td>
        <td class="td-span">
           <span>
             ${matchGocharPlanet?.nakshatra
                                                ? `${matchGocharPlanet.nakshatra} (${matchGocharPlanet.pada || ""}) <i class="color-bx color-pos-bx4 fa-regular fa-eye mx-2" class="fa-regular fa-eye mx-2" data-tooltip="${matchGocharPlanet.date_of_entry} - ${matchGocharPlanet.date_of_exit}"></i>`
                                                : "-"}</span>
        </td>
    </tr>`;
                                    }
                                });

                                // Append the matched and unmatched data to respective tables
                                document.getElementById("thirdTable").innerHTML = thirdTableContent;
                                document.getElementById("fourthTable").innerHTML = fourthTableContent;
                                document.getElementById("fifthTable").innerHTML = fifthTableContent;
                            }

                            // Event listener for divisional chart selection
                            document.getElementById("rashiNakSelect").addEventListener("change", (event) => {
                                selectedRasNak = event.target.value;

                                // Disable divisional chart selection if Nakshatra is selected
                                const divisionalSelect = document.getElementById("divisionalSelect");
                                if (selectedRasNak === "Nakshatra") {
                                    divisionalSelect.disabled = true;
                                } else {
                                    divisionalSelect.disabled = false;
                                }

                                updateTable(comparisonData, storedPadas, position, nakshatraPosition);
                            });

                            // Event listener for divisional chart selection
                            document.getElementById("divisionalSelect").addEventListener("change", (event) => {
                                selectedDivisional = event.target.value;
                                updateTable(comparisonData, storedPadas, position, nakshatraPosition);
                            });

                            currentIndex = (currentIndex + 9) % nakshatraPadas.length;
                        }
                    };

                    // Event listener for house selection
                    document.getElementById("houseDropdown").addEventListener("change", (event) => {
                        const selectedHouse = event.target.value;
                        populateHouseTable(selectedHouse);
                    });

                    const chartContainer1 = document.getElementById("horoscope-chart1");
                    chartContainer1.innerHTML = chart1Url;
                    const chartContainer2 = document.getElementById("horoscope-chart2");
                    chartContainer2.innerHTML = chart2Url;


                    if (horoscopeData && horoscopeData.response) {
                        const planetDatas = horoscopeData.response;
                        // Function to check if a value is defined
                        const isDefined = (value) => value !== undefined && value !== null && value !== "";

                        // Map Planet Data
                        const mapPlanetData = (data) => {
                            if (Array.isArray(data)) {
                                // If data is an array, map directly
                                return data.map((planet) => ({
                                    name: planet.full_name,
                                    zodiac: planet.zodiac,
                                    house: planet.house,
                                    nakshatra: planet.nakshatra,
                                    nakshatra_lord: planet.nakshatra_lord,
                                    zodiac_lord: planet.zodiac_lord,
                                    latitude: planet.local_degree,
                                    rishi: planet.nakshatra_lord,
                                    nakshatra_pada: planet.nakshatra_pada,
                                    relation: planet.zodiac_lord,
                                    retro: planet.retro,
                                    is_combust: planet.is_combust,
                                }));
                            } else if (typeof data === "object" && data !== null) {
                                // If data is an object, map its values
                                return Object.values(data).map((planet) => ({
                                    name: planet.full_name,
                                    zodiac: planet.zodiac,
                                    house: planet.house,
                                    nakshatra: planet.nakshatra,
                                    nakshatra_lord: planet.nakshatra_lord,
                                    zodiac_lord: planet.zodiac_lord,
                                    latitude: planet.local_degree,
                                    rishi: planet.nakshatra_lord,
                                    nakshatra_pada: planet.nakshatra_pada,
                                    relation: planet.zodiac_lord,
                                    retro: planet.retro,
                                    is_combust: planet.is_combust,
                                }));
                            } else {
                                console.error("Unexpected data format for planets:", data);
                                return [];
                            }
                        };

                        // Map Dasa Details
                        const mapDasaDetails = (data) => {
                            return {
                                birth_dasa: planetDatas.birth_dasa,
                                current_dasa: planetDatas.current_dasa,
                                lucky_gem: planetDatas.lucky_gem,
                                lucky_num: planetDatas.lucky_num,
                                lucky_colors: planetDatas.lucky_colors,
                                lucky_name_start: planetDatas.lucky_name_start,
                                lucky_letters: planetDatas.lucky_letters,
                                rasi: planetDatas.rasi,
                            };
                        };

                        // Map Panchang Details
                        const mapPanchangDetails = (data) => {
                            return {
                                ayanamsa: planetDatas.panchang.ayanamsa,
                                ayanamsa_name: planetDatas.panchang.ayanamsa_name,
                                karana: planetDatas.panchang.karana,
                                yoga: planetDatas.panchang.yoga,
                                day_of_birth: planetDatas.panchang.day_of_birth,
                                day_lord: planetDatas.panchang.day_lord,
                                hora_lord: planetDatas.panchang.hora_lord,
                                sunrise_at_birth: planetDatas.panchang.sunrise_at_birth,
                                sunset_at_birth: planetDatas.panchang.sunset_at_birth,
                                tithi: planetDatas.panchang.tithi,
                            };
                        };

                        // Populate Table
                        const populateTable = async () => {
                            const planetDataElement = document.getElementById("planet-data");
                            const dasaDataElement = document.getElementById("dasa-data");
                            const panchangDataElement = document.getElementById("panchang-data");

                            if (!horoscopeData || !horoscopeData.response) {
                                console.error("Horoscope data is invalid or missing.");
                                return;
                            }

                            // Map Data
                            const planets = mapPlanetData(horoscopeData.response).slice(0, 10);
                            const dasaDetails = mapDasaDetails(horoscopeData);
                            const panchangDetails = mapPanchangDetails(horoscopeData);

                            // Add Planets Data to Table
                            await planets.forEach((planet) => {
                                // Create the table row
                                const row = document.createElement("tr");

                                // Check if at least one field has valid data
                                const hasValidData = [
                                    planet.name,
                                    planet.zodiac,
                                    planet.house,
                                    planet.nakshatra,
                                    planet.nakshatra_lord,
                                    planet.zodiac_lord,
                                    planet.latitude,
                                    planet.rishi,
                                    planet.nakshatra_pada,
                                    planet.relation,
                                    planet.is_combust,
                                    planet.retro
                                ].some((value) => isDefined(value));

                                // If the row has valid data, populate the row
                                if (hasValidData) {
                                    row.innerHTML = `
            <td>${isDefined(planet.name) ? planet.name : "-"}</td>
            <td>${planet.retro ? "R" : " "}</td>
            <td>${planet.is_combust ? "C" : " "}</td>
            <td>${isDefined(planet.zodiac) ? planet.zodiac : "-"}</td>
            <td>${isDefined(planet.house) ? planet.house : "-"}</td>
            <td>${isDefined(planet.nakshatra_lord) ? planet.nakshatra_lord : "-"}</td>
            <td>${isDefined(planet.nakshatra) ? planet.nakshatra : "-"}</td>
            <td>${isDefined(planet.nakshatra_pada) ? planet.nakshatra_pada : "-"}</td>
            <td>${isDefined(planet.zodiac_lord) ? planet.zodiac_lord : "-"}</td>
            <td>${isDefined(planet.latitude) ? planet.latitude : "-"}</td>
        `;

                                    planetDataElement.appendChild(row);
                                }
                            });

                            // Utility function to check if a value is defined and not blank
                            function isDefined(value) {
                                return value !== undefined && value !== null && value !== "";
                            }

                            // Add Dasa Details to Table
                            dasaDataElement.innerHTML = `
<tr>
          <td colspan="2"><strong>Birth Dasa:</strong></td>
          <td colspan="8">${dasaDetails.birth_dasa || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Current Dasa:</strong></td>
          <td colspan="8">${dasaDetails.current_dasa || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Lucky Gem:</strong></td>
          <td colspan="8">${dasaDetails.lucky_gem || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Lucky Number:</strong></td>
          <td colspan="8">${dasaDetails.lucky_num || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Lucky Colors:</strong></td>
          <td colspan="8">${dasaDetails.lucky_colors || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Lucky Letters:</strong></td>
          <td colspan="8">${dasaDetails.lucky_letters || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Lucky Name Start:</strong></td>
          <td colspan="8">${dasaDetails.lucky_name_start || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Rasi:</strong></td>
          <td colspan="8">${dasaDetails.rasi || ""}</td>
        </tr>
  `;
                            // Add Dasa Details to Table
                            panchangDataElement.innerHTML = `
<tr>
          <td colspan="2"><strong>Ayanamsa:</strong></td>
          <td colspan="8">${panchangDetails.ayanamsa || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Ayanamsa_name:</strong></td>
          <td colspan="8">${panchangDetails.ayanamsa_name || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Karana:</strong></td>
          <td colspan="8">${panchangDetails.karana || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Yoga:</strong></td>
          <td colspan="8">${panchangDetails.yoga || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Day of birth:</strong></td>
          <td colspan="8">${panchangDetails.day_of_birth || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Day lord:</strong></td>
          <td colspan="8">${panchangDetails.day_lord || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Hora lord:</strong></td>
          <td colspan="8">${panchangDetails.hora_lord || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Sunrise at birth:</strong></td>
          <td colspan="8">${panchangDetails.sunrise_at_birth || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Sunset at birth:</strong></td>
          <td colspan="8">${panchangDetails.sunset_at_birth || ""}</td>
        </tr>
        <tr>
          <td colspan="2"><strong>Tithi:</strong></td>
          <td colspan="8">${panchangDetails.tithi || ""}</td>
        </tr>
  `;
                        };

                        populateHouseTable("1");
                        populateTable()

                    } else {
                        console.error("Horoscope data not found or invalid in localStorage.");
                    }
                    async function DashaData() {
                        const dashaInfo = mahaDashaData.response;
                        const antardashaInfo = antarDashaData.response;
                        const chardashaInfo = charDashaData.response;
                        const charsubdashaInfo = charsubDashaData.response;
                        const yoginidashaInfo = yoginiDashaData.response;
                        const yoginisubdashaInfo = yoginisubDashaData.response;
                        const paryantardashaInfo = paryantarDashaData.response;
                        // console.log(dashaInfo, "dashaInfo")
                        // console.log(antardashaInfo, "antardashaInfo")
                        // console.log(chardashaInfo, "charDashaData")
                        // console.log(charsubdashaInfo, "charsubDashaData")
                        // console.log(yoginidashaInfo, "yoginidashaInfo")
                        // console.log(yoginisubdashaInfo, "yoginisubdashaInfo")
                        // console.log(paryantardashaInfo, "paryantardashaInfo")

                        // Set top information
                        document.getElementById("dasha_remaining").innerText = dashaInfo.dasha_remaining_at_birth;
                        document.getElementById("dasha_start_date").innerText = dashaInfo.dasha_start_date;
                        document.getElementById("start_year").innerText = dashaInfo.start_year;

                        // Populate table
                        const tableBody = document.getElementById("dashaTableBody");
                        dashaInfo.mahadasha.forEach((planet, index) => {
                            const row = `<tr>
                                <td>${planet}</td>
                                <td>${dashaInfo.mahadasha_order[index]}</td>
                            </tr>`;
                            tableBody.innerHTML += row;
                        });

                        // Populate table of antar dasha
                        const andarTableBody = document.getElementById("antardashaTableBody");
                        antardashaInfo.antardashas.forEach((planetList, i) => {
                            planetList.forEach((planet, j) => {
                                const arow = `<tr>
                                    <td>${planet}</td>
                                    <td>${antardashaInfo.antardasha_order[i][j] || "N/A"}</td>
                                 </tr>`;
                                andarTableBody.innerHTML += arow;
                            });
                        })

                        // Display start date
                        document.getElementById("startDate").textContent = chardashaInfo.start_date;

                        // Populate table
                        const chartableBody = document.getElementById("charDashaTableBody");
                        chardashaInfo.dasha_list.forEach((sign, index) => {
                            const crow = `<tr>
                    <td>${sign}</td>
                    <td>${chardashaInfo.dasha_end_dates[index] || "N/A"}</td>
                 </tr>`;
                            chartableBody.innerHTML += crow;
                        });

                        // Populate table
                        const charstableBody = document.getElementById("charSubDashaTableBody");
                        charsubdashaInfo.forEach(dasha => {
                            dasha.sub_dasha_list.forEach((subDasha, index) => {
                                const csrow = `<tr>
                                    <td>${dasha.main_dasha}</td>
                                    <td>${dasha.main_dasha_lord}</td>
                                    <td>${subDasha}</td>
                                    <td>${dasha.sub_dasha_start_date || "N/A"}</td>
                                    <td>${dasha.sub_dasha_end_dates[index] || "N/A"}</td>
                                 </tr>`;
                                charstableBody.innerHTML += csrow;
                            });
                        });

                        const paryanttableBody = document.getElementById("paryantarDashaTableBody");
                        paryantardashaInfo.paryantardasha.forEach((parrow, parrowIndex) => {
                            parrow.forEach((entry, colIndex) => {
                                let parstartDatevalues = [];

                                if (typeof entry === "string") {
                                    values = entry.split("/"); // Normal case
                                } else if (Array.isArray(entry)) {
                                    values = entry; // Use array directly
                                } else {
                                    console.warn("Unexpected entry format:", entry);
                                    return; // Skip this entry
                                }

                                const parstartDate = paryantardashaInfo.paryantardasha_order[parrowIndex]?.[colIndex] || "N/A";
                                values.forEach((value, i) => {
                                    const parrow = `<tr>
                                    <td>${value || "-"}</td>
                                    <td>${parstartDate[i] || "-"}</td>
                                </tr>`;

                                    paryanttableBody.innerHTML += parrow;
                                });
                            });
                        });

                        // yoginiDasha
                        const yogintableBody = document.getElementById("yoginiDashaTableBody");
                        // yoginistartDate
                        // Display start date
                        document.getElementById("yoginistartDate").textContent = yoginidashaInfo.start_date;
                        yoginidashaInfo.dasha_list.forEach((dasha, index) => {
                            const dashaEndDate = yoginidashaInfo.dasha_end_dates[index] || "-";
                            const dashaLord = yoginidashaInfo.dasha_lord_list[index] || "-";

                            const rowHTML = `<tr>
                            <td>${dasha}</td>
                            <td>${dashaLord}</td>
                            <td>${dashaEndDate}</td>
                        </tr>`;

                            yogintableBody.innerHTML += rowHTML;
                        });

                        // yoginisub 

                        const yoginsubtableBody = document.getElementById("yoginiSubDashaTableBody");
                        yoginisubdashaInfo.forEach((mainDashaEntry, index) => {
                            const mainDasha = mainDashaEntry.main_dasha || "-";
                            const mainDashaLord = mainDashaEntry.main_dasha_lord || "-";
                            let rowHTML = `<tr>
                          <td rowspan="${mainDashaEntry.sub_dasha_list.length}">${mainDasha}</td>
                          <td rowspan="${mainDashaEntry.sub_dasha_list.length}">${mainDashaLord}</td>`;

                            mainDashaEntry.sub_dasha_list.forEach((subDasha, subIndex) => {
                                const subDashaStart = mainDashaEntry.sub_dasha_start_dates[subIndex] || "-";
                                const subDashaEnd = mainDashaEntry.sub_dasha_end_dates[subIndex] || "-";

                                if (subIndex > 0) rowHTML += "<tr>";
                                rowHTML += `<td>${subDasha}</td>
                        <td>${subDashaStart}</td>
                        <td>${subDashaEnd}</td>
                    </tr>`;
                            });
                            yoginsubtableBody.innerHTML += rowHTML;
                        });
                    }

                    DashaData();
                }
            }
            catch (error) {
                console.log(error, "error")
            }

            document.querySelector(".login-reg-comp").classList.remove("formactive");
            const loginForm = document.querySelector(".login-info");
            loginForm.style.display = "none";
            modal.style.display = "none";
            const profileInfo = document.querySelector(".profile-info");
            profileInfo.style.display = "block";
        }

        document.addEventListener("DOMContentLoaded", function () {
            // console.log(token, "token")
            const loginForm = document.querySelector(".login-info");
            const regInfo = document.querySelector(".reg-info");
            const profileInfo = document.querySelector(".profile-info");
            const loader = document.querySelector(".signup-loader");

            if (token) {
                // User is logged in, show profile and hide login/signup forms
                loginForm.style.display = "none";
                regInfo.style.display = "none";
                profileInfo.style.display = "block";
                loader.style.display = "none";
            } else {
                // User is not logged in, show login/signup forms
                loginForm.style.display = "block";
                regInfo.style.display = "block";
                profileInfo.style.display = "none";
                loader.style.display = "none";
            }

            // Logout functionality
            const logoutBox = document.getElementById("logoutBox");
            if (logoutBox) {
                logoutBox.addEventListener("click", function () {
                    localStorage.removeItem("token");
                    localStorage.removeItem('params');
                    // location.reload();
                    window.location.href = "./index.html";
                });
            }
        });

        // Populate table on page load
        window.onload = async () => {
            fetchAllData()
        };

    </script>



    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <!-- Swiper Js file -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <!-- script file -->
    <script src="./js/index.js"></script>
    <script src="./js/Dropdown.js"></script>
    <script>
        var swiper = new Swiper(".homeSwiper", {
            autoplay: {
                delay: 2500,
                disableOnInteraction: false,
            },
            pagination: {
                el: ".swiper-pagination",
                dynamicBullets: true,
            },
        });

        // blog and video card swiper code
        var swiper = new Swiper(".blogvideoSwiper", {
            slidesPerView: 3,
            spaceBetween: 30,
            freeMode: true,
            breakpoints: {
                // When the viewport is ≥ 480px
                320: {
                    slidesPerView: 1,
                    spaceBetween: 0,
                },
                // When the viewport is ≥ 768px
                768: {
                    slidesPerView: 2,
                    spaceBetween: 20,
                },
                // When the viewport is ≥ 1024px
                1024: {
                    slidesPerView: 3,
                    spaceBetween: 30,
                },
            },
            navigation: {
                nextEl: ".blog-next",
                prevEl: ".blog-prev",
            },
            autoplay: {
                delay: 3500,
                disableOnInteraction: false,
            },

        });

        var swiper2 = new Swiper(".videoSlider", {
            slidesPerView: 3,
            spaceBetween: 30,
            freeMode: true,
            breakpoints: {
                // When the viewport is ≥ 480px
                320: {
                    slidesPerView: 1,
                    spaceBetween: 0,
                },
                // When the viewport is ≥ 768px
                768: {
                    slidesPerView: 2,
                    spaceBetween: 20,
                },
                // When the viewport is ≥ 1024px
                1024: {
                    slidesPerView: 3,
                    spaceBetween: 30,
                },
            },
            navigation: {
                nextEl: ".video-next",
                prevEl: ".video-prev",
            },
            autoplay: {
                delay: 4000,
                disableOnInteraction: false,
            },
        });



    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            flatpickr("#timePicker", {
                enableTime: true,
                noCalendar: true,
                dateFormat: "h:i K", // Format to include AM/PM
                time_24hr: false // Use 12-hour clock with AM/PM
            });

            flatpickr("#calendarInput", {
                dateFormat: "Y-m-d", // Format: YYYY-MM-DD
                maxDate: "2025-12-31", // Adjust maxDate if needed
                enableTime: false   // Disable time selection
            });
        });
    </script>



</body>

</html>